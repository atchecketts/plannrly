# Feature 3.8: Timesheet Export

**Status:** Pending
**Effort:** Medium
**Phase:** 3 - Time & Attendance

## Overview

Export timesheets for payroll processing. This feature allows managers to export timesheet data in various formats suitable for integration with payroll systems or for record-keeping purposes.

## Requirements

### Functional Requirements
- Multiple export formats (CSV, Excel, PDF)
- Configurable date range
- Filter by employee, department, location
- Include all relevant timesheet data

### Export Formats
| Format | Description |
|--------|-------------|
| CSV | Basic comma-separated values |
| Excel | Formatted spreadsheet with headers |
| PDF | Printable document |

### Export Data Columns
- Employee name
- Date
- Scheduled start/end
- Actual start/end
- Scheduled hours
- Actual hours
- Variance
- Break time
- Notes
- Status

## Files

### To Create
- `app/Http/Controllers/TimesheetExportController.php`
- `app/Exports/TimesheetExport.php` (Laravel Excel)
- `app/Services/TimesheetExportService.php`

## Tasks

- [ ] Install Laravel Excel package
- [ ] Create TimesheetExportController
- [ ] Create TimesheetExport class
- [ ] Implement CSV export
- [ ] Implement Excel export with formatting
- [ ] Implement PDF export
- [ ] Add export buttons to timesheet views
- [ ] Write tests

## Export Service Methods

```php
TimesheetExportService:
- exportToCsv($dateRange, $filters)
- exportToExcel($dateRange, $filters)
- exportToPdf($dateRange, $filters)
- getExportData($dateRange, $filters)
- formatForPayroll($data) // Standard payroll format
```

## Dependencies

- TimeEntry model
- Shift model
- User model
- Laravel Excel package (maatwebsite/excel)
- DomPDF or similar for PDF generation
- Feature 3.4 (Timesheet Views)
