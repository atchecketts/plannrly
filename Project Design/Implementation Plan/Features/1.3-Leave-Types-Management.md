# Feature 1.3: Leave Types Management

**Status:** Completed
**Effort:** Medium
**Phase:** 1 - Core Features

## Overview

Admins need to manage leave types (Annual Leave, Sick Leave, etc.) that employees can use when requesting time off. Each leave type has configurable properties that affect how leave requests are processed.

## Requirements

### Functional Requirements
- Admins can create, edit, and delete leave types
- Each leave type has configurable properties:
  - Name and color
  - Requires approval (yes/no)
  - Affects allowance (deducts from annual allowance)
  - Is paid leave (yes/no)
  - Is active (can be requested)
- Leave types with existing requests cannot be deleted
- Leave types are tenant-scoped (each organization has their own)

### Authorization
- Only Admins and SuperAdmins can manage leave types
- Employees cannot access leave type management
- Admins can only manage leave types in their own tenant

## Files

### Created
- `app/Http/Controllers/LeaveTypeController.php`
- `app/Http/Requests/LeaveType/StoreLeaveTypeRequest.php`
- `app/Http/Requests/LeaveType/UpdateLeaveTypeRequest.php`
- `app/Policies/LeaveTypePolicy.php`
- `resources/views/leave-types/index.blade.php`
- `resources/views/leave-types/create.blade.php`
- `resources/views/leave-types/edit.blade.php`
- `tests/Feature/LeaveTypeManagementTest.php`

### Routes
```php
Route::resource('leave-types', LeaveTypeController::class)->except(['show']);
```

## Tasks

- [x] Create LeaveTypeController with CRUD actions
- [x] Create StoreLeaveTypeRequest with validation
- [x] Create UpdateLeaveTypeRequest with validation and tenant check
- [x] Create LeaveTypePolicy for authorization
- [x] Create index view listing all leave types with properties
- [x] Create create form with all properties
- [x] Create edit form
- [x] Add routes to web.php
- [x] Add navigation link to sidebar
- [x] Write comprehensive tests (13 tests)

## Leave Type Properties

| Property | Type | Description |
|----------|------|-------------|
| name | string | Display name (e.g., "Annual Leave") |
| color | hex | Color code for visual identification |
| requires_approval | boolean | Manager must approve requests |
| affects_allowance | boolean | Deducts from employee's annual allowance |
| is_paid | boolean | Employee receives pay during leave |
| is_active | boolean | Employees can request this leave type |

## Tests

All tests located in `tests/Feature/LeaveTypeManagementTest.php`:

1. `test_admin_can_view_leave_types_index`
2. `test_employee_cannot_view_leave_types_index`
3. `test_admin_can_view_create_leave_type_form`
4. `test_admin_can_create_leave_type`
5. `test_leave_type_requires_name`
6. `test_leave_type_requires_valid_color`
7. `test_admin_can_view_edit_leave_type_form`
8. `test_admin_can_update_leave_type`
9. `test_admin_can_delete_leave_type_without_requests`
10. `test_admin_cannot_delete_leave_type_with_requests`
11. `test_index_shows_leave_type_properties`
12. `test_index_shows_leave_request_count`
13. `test_admin_from_different_tenant_cannot_update_leave_type`

## Dependencies

- LeaveType model
- LeaveRequest model (for deletion check)
- Tenant model
- User role system (isAdmin, isSuperAdmin)
