# Feature 20.1: Onboarding Wizard

**Status:** Not Started
**Effort:** Large
**Phase:** 20 - Onboarding & Import

## Overview

Guided setup experience for new tenants. This wizard walks new users through essential configuration steps to get their organization up and running quickly with Plannrly.

## Requirements

### Functional Requirements
- Step-by-step wizard for initial setup
- Progress tracking across sessions
- Skippable optional steps
- Sample data loader for exploration
- Persistent checklist after wizard completion
- Contextual help and tutorial videos

### Wizard Steps

1. **Organization Details** (Required)
   - Organization name
   - Industry/sector
   - Size (employee count range)
   - Primary contact info

2. **First Location** (Required)
   - Location name
   - Address
   - Timezone
   - Operating hours

3. **Departments** (Optional)
   - Create departments
   - Assign to location
   - Skip if single-department

4. **Business Roles** (Required)
   - Create job roles
   - Set hourly rates (optional)
   - Define required skills

5. **Invite Team** (Required)
   - Add employee emails
   - Assign roles
   - Send invitations

6. **First Schedule** (Optional)
   - Create initial schedule
   - Load sample shifts
   - Preview and publish

### Sample Data
- Pre-populated demo schedule
- Example employees with shifts
- Sample leave requests
- Demo reports data

## Files

### To Create
- `app/Models/OnboardingProgress.php`
- `app/Services/OnboardingService.php`
- `app/Services/SampleDataService.php`
- `app/Http/Controllers/OnboardingController.php`
- `app/Http/Requests/Onboarding/OrganizationStepRequest.php`
- `app/Http/Requests/Onboarding/LocationStepRequest.php`
- `app/Http/Requests/Onboarding/DepartmentsStepRequest.php`
- `app/Http/Requests/Onboarding/RolesStepRequest.php`
- `app/Http/Requests/Onboarding/InviteStepRequest.php`
- `resources/views/onboarding/wizard.blade.php`
- `resources/views/onboarding/steps/organization.blade.php`
- `resources/views/onboarding/steps/location.blade.php`
- `resources/views/onboarding/steps/departments.blade.php`
- `resources/views/onboarding/steps/roles.blade.php`
- `resources/views/onboarding/steps/invite.blade.php`
- `resources/views/onboarding/steps/schedule.blade.php`
- `resources/views/onboarding/checklist.blade.php`
- `database/migrations/xxxx_create_onboarding_progress_table.php`
- `tests/Feature/OnboardingWizardTest.php`

### Routes
```php
Route::prefix('onboarding')->name('onboarding.')->group(function () {
    Route::get('/', [OnboardingController::class, 'index'])->name('index');
    Route::get('step/{step}', [OnboardingController::class, 'step'])->name('step');
    Route::post('step/{step}', [OnboardingController::class, 'saveStep'])->name('save-step');
    Route::post('skip/{step}', [OnboardingController::class, 'skipStep'])->name('skip-step');
    Route::post('complete', [OnboardingController::class, 'complete'])->name('complete');
    Route::post('load-sample-data', [OnboardingController::class, 'loadSampleData'])->name('load-sample-data');
    Route::delete('clear-sample-data', [OnboardingController::class, 'clearSampleData'])->name('clear-sample-data');
});
```

## Database Schema

### onboarding_progress
| Column | Type | Description |
|--------|------|-------------|
| id | bigint | Primary key |
| tenant_id | bigint | Foreign key to tenants |
| current_step | integer | Current step (1-6) |
| completed_steps | json | Array of completed step numbers |
| skipped_steps | json | Array of skipped step numbers |
| step_data | json | Saved data for each step |
| sample_data_loaded | boolean | Sample data is active |
| completed_at | timestamp | Wizard completion time |
| created_at | timestamp | |
| updated_at | timestamp | |

## Tasks

- [ ] Create onboarding_progress migration
- [ ] Create OnboardingProgress model
- [ ] Create OnboardingService for step management
- [ ] Create SampleDataService for demo data
- [ ] Create OnboardingController
- [ ] Create Form Request for each step
- [ ] Design step-by-step wizard UI
- [ ] Implement Step 1: Organization details
- [ ] Implement Step 2: First location
- [ ] Implement Step 3: Departments (skippable)
- [ ] Implement Step 4: Business roles
- [ ] Implement Step 5: Invite team
- [ ] Implement Step 6: First schedule
- [ ] Add visual progress indicator
- [ ] Create sample data loader
- [ ] Add "Clear sample data" option
- [ ] Create persistent checklist component
- [ ] Add contextual help tooltips
- [ ] Integrate tutorial videos
- [ ] Write comprehensive tests

## Tests

Planned tests for `tests/Feature/OnboardingWizardTest.php`:

1. `test_new_tenant_sees_onboarding_wizard`
2. `test_can_complete_organization_step`
3. `test_can_complete_location_step`
4. `test_can_skip_departments_step`
5. `test_can_complete_roles_step`
6. `test_can_invite_team_members`
7. `test_can_create_first_schedule`
8. `test_progress_persists_across_sessions`
9. `test_can_load_sample_data`
10. `test_can_clear_sample_data`
11. `test_completed_wizard_shows_checklist`
12. `test_can_navigate_between_steps`
13. `test_validation_errors_shown_per_step`

## Dependencies

- Tenant model
- Location model
- Department model
- BusinessRole model
- User model and invitation system
- Schedule model
