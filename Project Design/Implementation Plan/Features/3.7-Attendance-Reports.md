# Feature 3.7: Attendance Reports

**Status:** Pending
**Effort:** Large
**Phase:** 3 - Time & Attendance

## Overview

Generate attendance and time variance reports. This feature provides comprehensive reporting on employee attendance patterns, punctuality, overtime, and absences to help managers make informed decisions about staffing and identify issues.

## Requirements

### Functional Requirements
- Multiple report types (see table below)
- Date range filtering
- Department/location filtering
- Export to CSV/PDF
- Charts and visualizations

### Reports to Include
| Report | Description |
|--------|-------------|
| Punctuality Report | On-time vs late arrivals by employee/dept |
| Hours Worked Report | Scheduled vs actual hours comparison |
| Overtime Report | Overtime hours by employee/department |
| Absence Report | No-shows and missed shifts |
| Attendance Summary | Overall attendance rate metrics |

### Metrics to Calculate
- Attendance rate: (shifts worked / shifts scheduled) x 100
- Punctuality rate: (on-time arrivals / total arrivals) x 100
- Average variance: Mean difference from scheduled times
- Total overtime hours: Sum of positive variances
- Total undertime hours: Sum of negative variances

## Files

### To Create
- `app/Http/Controllers/AttendanceReportController.php`
- `resources/views/reports/attendance/index.blade.php`
- `resources/views/reports/attendance/employee.blade.php`
- `resources/views/reports/attendance/department.blade.php`
- `app/Services/AttendanceReportService.php`
- `tests/Feature/AttendanceReportTest.php`

## Tasks

- [ ] Create AttendanceReportService for calculations
- [ ] Create AttendanceReportController
- [ ] Create punctuality report view
- [ ] Create hours worked report with scheduled vs actual
- [ ] Create overtime analysis report
- [ ] Create absence/no-show report
- [ ] Create attendance summary dashboard
- [ ] Add date range filtering
- [ ] Add department/location filtering
- [ ] Add export to CSV/PDF
- [ ] Add charts/visualizations
- [ ] Write tests

## Report Service Methods

```php
AttendanceReportService:
- getAttendanceRate($dateRange, $filters)
- getPunctualityRate($dateRange, $filters)
- getOvertimeHours($dateRange, $filters)
- getUndertimeHours($dateRange, $filters)
- getMissedShifts($dateRange, $filters)
- getEmployeeSummary($employeeId, $dateRange)
- getDepartmentSummary($departmentId, $dateRange)
- generatePunctualityReport($dateRange, $filters)
- generateHoursWorkedReport($dateRange, $filters)
- generateOvertimeReport($dateRange, $filters)
- generateAbsenceReport($dateRange, $filters)
```

## Dependencies

- TimeEntry model with variance accessors
- Shift model
- User model
- Department model
- Location model
- Feature 3.3 (Scheduled vs Actual Time Variance)
- Export functionality (CSV/PDF)
- Chart library (Chart.js or similar)
