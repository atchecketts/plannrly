# Feature 4.2: Notification Preferences UI

**Status:** Complete
**Effort:** Small
**Phase:** 4 - Notifications

## Overview

Allow users to manage their notification preferences through a settings interface. Users can toggle different notification types and channels (email, in-app) according to their preferences.

## Requirements

### Functional Requirements
- Toggle email notifications per notification type
- Toggle in-app notifications per notification type
- Preferences are saved per user
- System respects preferences when sending notifications

### Notification Types Configurable
- Shift assignments (shift_published)
- Shift changes (shift_changed)
- Shift reminders (shift_reminder)
- Leave request status (leave_request_status)
- Swap requests received (swap_request)
- Swap request responses (swap_request_response)
- Missed shift alerts (missed_shift)

## Files

### Created
- `app/Http/Controllers/NotificationPreferenceController.php`
- `resources/views/notifications/preferences.blade.php`

### Modified
- `routes/web.php` - Added notification preference routes

## Routes

```
GET  /notifications/preferences     - View preferences page
PUT  /notifications/preferences     - Update preferences
```

## Tasks

- [x] Create NotificationPreferenceController
- [x] Create preferences UI with toggles for each notification type
- [x] Allow toggling email/in-app per notification type
- [x] Store preferences in notification_preferences table
- [x] Add routes for preferences management
- [x] Write tests

## Preferences Data Structure

Stored in `notification_preferences` table:
```php
// Each row represents one notification type for one user
[
    'user_id' => 1,
    'notification_type' => 'shift_published',
    'email_enabled' => true,
    'in_app_enabled' => true,
    'push_enabled' => false, // For future mobile support
]
```

## UI Layout

The preferences page displays:
- Table with notification types as rows
- Description of each notification type
- Columns for Email and In-App channels
- Toggle switches for each combination
- Save button to persist all changes at once

## Controller Methods

- `index()` - Display preferences form with current settings
- `update()` - Save all preference changes

## Dependencies

- User model with notificationPreferences() relationship
- NotificationPreference model
- All notification classes from Feature 4.1
