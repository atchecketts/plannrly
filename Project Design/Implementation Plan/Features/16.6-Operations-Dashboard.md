# Feature 16.6: Real-Time Operations Dashboard

**Status:** Not Started
**Effort:** Medium
**Phase:** 16 - Scheduling Enhancements

## Overview

Live view of current workforce status showing who's working now, who's expected, and any issues like late or missing employees. Provides real-time operational visibility.

## Requirements

### Functional Requirements
- Display "Who's Working Now" view
- Show clocked-in employees with details
- Show expected arrivals in next 1-2 hours
- Highlight late/missing employees
- Quick contact actions (call, message)
- Show coverage status per location
- Auto-refresh every minute
- Send reminder action for late employees

### Dashboard Sections
1. **Currently Clocked In**: Active employees with start time
2. **Expected Soon**: Shifts starting in next 1-2 hours
3. **Late/Missing**: Past start time, not clocked in
4. **Coverage Summary**: Headcount per location/role

### UI Components
- Real-time employee status cards
- Location/role coverage bars
- Late employee alerts
- Quick action buttons
- Auto-refresh indicator

## Files

### To Create
- `app/Http/Controllers/OperationsDashboardController.php` - Controller
- `resources/views/operations/dashboard.blade.php` - Dashboard view
- `tests/Feature/OperationsDashboardTest.php` - Feature tests

### Routes
```php
Route::get('operations', [OperationsDashboardController::class, 'index'])->name('operations.index');
Route::get('operations/data', [OperationsDashboardController::class, 'data'])->name('operations.data');
Route::post('operations/send-reminder/{user}', [OperationsDashboardController::class, 'sendReminder'])->name('operations.send-reminder');
```

## Dashboard Data Structure

```php
[
    'clocked_in' => [
        ['user' => User, 'shift' => Shift, 'clock_in_time' => Carbon, 'location' => Location],
        // ...
    ],
    'expected_soon' => [
        ['user' => User, 'shift' => Shift, 'start_time' => Carbon, 'minutes_until' => int],
        // ...
    ],
    'late' => [
        ['user' => User, 'shift' => Shift, 'start_time' => Carbon, 'minutes_late' => int],
        // ...
    ],
    'coverage' => [
        'location_name' => ['expected' => 5, 'present' => 3, 'percentage' => 60],
        // ...
    ],
    'last_updated' => Carbon,
]
```

## Tasks

- [ ] Create "Who's Working Now" view
- [ ] Show clocked-in employees with details
- [ ] Show expected arrivals (next 1-2 hours)
- [ ] Highlight late/missing employees
- [ ] Add quick contact actions
- [ ] Show coverage status per location
- [ ] Auto-refresh every minute
- [ ] Add send reminder action for late employees
- [ ] Write tests

## Tests

Suggested tests for `tests/Feature/OperationsDashboardTest.php`:

1. `test_admin_can_view_operations_dashboard`
2. `test_dashboard_shows_clocked_in_employees`
3. `test_dashboard_shows_expected_arrivals`
4. `test_dashboard_highlights_late_employees`
5. `test_late_detection_works_correctly`
6. `test_coverage_percentage_is_calculated`
7. `test_admin_can_send_reminder_to_late_employee`
8. `test_data_endpoint_returns_json`
9. `test_employee_cannot_access_operations_dashboard`

## Dependencies

- Shift model
- TimeEntry model (clock in/out records)
- User model
- Location model
- Notification system for reminders
