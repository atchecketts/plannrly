# Feature 3.3: Scheduled vs Actual Time Variance

**Status:** Pending
**Effort:** Medium
**Phase:** 3 - Time & Attendance

## Overview

Calculate and display variances between scheduled and actual times. This feature provides computed metrics that help managers identify attendance patterns such as late arrivals, early departures, overtime, and no-shows.

## Requirements

### Functional Requirements
- Calculate actual duration worked
- Calculate scheduled duration from shift
- Calculate variance (overtime/undertime)
- Track early/late arrival
- Track early/late departure
- Identify overtime shifts
- Identify no-show situations
- Color coding for variance display (green=good, yellow=minor, red=issue)

### Computed Fields to Implement on TimeEntry Model
```php
getActualDurationMinutesAttribute()      // Total actual work time
getScheduledDurationMinutesAttribute()   // Shift scheduled duration
getVarianceMinutesAttribute()            // Difference (+ overtime, - undertime)
getClockInVarianceMinutesAttribute()     // Early/late arrival
getClockOutVarianceMinutesAttribute()    // Early/late departure
getIsLateAttribute()                     // Boolean: arrived late
getIsEarlyDepartureAttribute()           // Boolean: left early
getIsOvertimeAttribute()                 // Boolean: worked overtime
getIsNoShowAttribute()                   // Boolean: missed shift entirely
```

## Files

### To Modify
- `app/Models/TimeEntry.php` - Add computed accessors

### To Create
- Unit tests for variance calculations

## Tasks

- [ ] Add all computed accessor methods to TimeEntry model
- [ ] Create helper methods for variance calculations
- [ ] Add variance display to time entry views
- [ ] Add color coding (green=good, yellow=minor, red=issue)
- [ ] Write unit tests for all calculations

## Variance Color Coding

| Variance | Color | Threshold |
|----------|-------|-----------|
| On Time | Green | Within grace period |
| Minor Late | Yellow | 1-15 minutes late |
| Late | Red | More than 15 minutes late |
| Early | Blue | Arrived early |
| Overtime | Orange | Worked past scheduled end |
| Undertime | Red | Left before scheduled end |

## Dependencies

- TimeEntry model
- Shift model with scheduled times
- TenantSettings for grace period configuration
