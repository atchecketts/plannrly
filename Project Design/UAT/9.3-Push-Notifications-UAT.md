# UAT: Feature 9.3 - Push Notifications

## Test Environment Setup

**Prerequisites:**
- Admin and employee user accounts
- Browser with push notification support (Chrome, Firefox, Edge)
- Published shifts for testing
- VAPID keys configured on server

**Test URL:** `/settings/notifications`

---

## Test Cases

### TC-9.3.1: Request Notification Permission

**Steps:**
1. Log in as an employee (new user or cleared permissions)
2. Navigate to notification settings
3. Click "Enable Push Notifications"

**Expected Results:**
- [ ] Browser permission prompt appears
- [ ] Prompt asks to allow notifications from Plannrly
- [ ] User can accept or deny permission

---

### TC-9.3.2: Subscribe to Push Notifications

**Steps:**
1. Accept notification permission (TC-9.3.1)
2. Observe subscription process

**Expected Results:**
- [ ] Subscription is created successfully
- [ ] Confirmation message displayed
- [ ] Status shows "Notifications Enabled"
- [ ] Subscription saved to database

---

### TC-9.3.3: View Notification Preferences

**Steps:**
1. Log in as an employee
2. Navigate to Settings > Notifications

**Expected Results:**
- [ ] Page loads successfully
- [ ] Shows notification categories:
  - Schedule changes
  - Shift reminders
  - Leave request updates
  - Swap request updates
- [ ] Toggle for each category
- [ ] Quiet hours configuration visible

---

### TC-9.3.4: Configure Notification Preferences

**Steps:**
1. Navigate to notification settings
2. Toggle various notification types:
   - Enable shift reminders
   - Disable schedule changes
3. Save preferences

**Expected Results:**
- [ ] Changes save successfully
- [ ] Preferences persist after page reload
- [ ] Only enabled notification types are received

---

### TC-9.3.5: Receive Schedule Published Notification

**Steps:**
1. As employee, ensure subscribed to schedule notifications
2. As admin, publish a schedule containing the employee's shifts
3. Observe employee's device

**Expected Results:**
- [ ] Push notification appears on employee's device
- [ ] Notification title mentions schedule/shifts
- [ ] Notification body contains relevant information
- [ ] Clicking notification opens schedule page

---

### TC-9.3.6: Receive Shift Reminder Notification

**Steps:**
1. As employee, enable shift reminders
2. Configure reminder timing (e.g., 1 hour before)
3. Have a shift scheduled within the reminder window
4. Wait for reminder time

**Expected Results:**
- [ ] Reminder notification appears at configured time
- [ ] Shows shift time and location
- [ ] Clicking opens shift details

---

### TC-9.3.7: Receive Leave Request Status Notification

**Steps:**
1. As employee, submit a leave request
2. As admin, approve or deny the request
3. Observe employee's device

**Expected Results:**
- [ ] Notification appears on employee's device
- [ ] Shows approval/denial status
- [ ] Clicking opens leave request details

---

### TC-9.3.8: Receive Swap Request Notification

**Steps:**
1. As Employee A, create a shift swap request for Employee B
2. Observe Employee B's device

**Expected Results:**
- [ ] Employee B receives notification of swap request
- [ ] Notification includes relevant shift details
- [ ] Clicking opens swap request for action

---

### TC-9.3.9: Configure Quiet Hours

**Steps:**
1. Navigate to notification settings
2. Enable quiet hours
3. Set quiet hours window (e.g., 22:00 - 07:00)
4. Save preferences

**Expected Results:**
- [ ] Quiet hours settings save successfully
- [ ] Notifications during quiet hours are suppressed
- [ ] Notifications resume after quiet hours end

---

### TC-9.3.10: Unsubscribe from Push Notifications

**Steps:**
1. Navigate to notification settings
2. Click "Disable Push Notifications"
3. Confirm action

**Expected Results:**
- [ ] Subscription is removed
- [ ] Status changes to "Notifications Disabled"
- [ ] No more push notifications received
- [ ] Can re-subscribe later

---

### TC-9.3.11: Notification Click Opens App

**Steps:**
1. Receive a push notification (app closed)
2. Click/tap the notification

**Expected Results:**
- [ ] App opens to relevant page
- [ ] User is logged in (if session valid)
- [ ] Correct context is shown (e.g., schedule, leave request)

---

### TC-9.3.12: Multiple Device Subscription

**Steps:**
1. Log in on Device A, subscribe to notifications
2. Log in on Device B, subscribe to notifications
3. Trigger a notification event

**Expected Results:**
- [ ] Both devices receive the notification
- [ ] Unsubscribing on one device doesn't affect the other
- [ ] Each subscription is tracked separately

---

### TC-9.3.13: Permission Denied Handling

**Steps:**
1. When permission prompt appears, click "Block/Deny"
2. Try to enable notifications again

**Expected Results:**
- [ ] Clear message explains notifications are blocked
- [ ] Instructions provided for browser settings
- [ ] No errors thrown

---

### TC-9.3.14: Browser Without Push Support

**Steps:**
1. Open Plannrly in a browser without push support
2. Navigate to notification settings

**Expected Results:**
- [ ] Message indicates push not supported
- [ ] No errors or broken UI
- [ ] Alternative notification options shown (if any)

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test on multiple browsers and devices
- Verify notifications work on both Android and iOS
