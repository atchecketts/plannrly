# UAT: Feature 4.2 - Notification Preferences UI

## Test Environment Setup

**Prerequisites:**
- Employee user accounts
- Admin user account
- Notification system active (from Feature 4.1)
- Email testing capability

**Test URLs:**
- Profile/Settings: `/profile/notifications` or `/settings/notifications`
- Dashboard: `/dashboard`

---

## Test Cases

### TC-4.2.1: Access Notification Preferences Page

**Steps:**
1. Log in as any user
2. Navigate to profile or settings
3. Find notification preferences section

**Expected Results:**
- [ ] Notification preferences page loads
- [ ] All notification types are listed
- [ ] Current preferences displayed correctly
- [ ] Page accessible to all user roles

---

### TC-4.2.2: View Default Preferences

**Steps:**
1. Log in as a new user (no preferences set)
2. Navigate to notification preferences

**Expected Results:**
- [ ] All notifications enabled by default (or sensible defaults)
- [ ] Email channel enabled by default
- [ ] In-app channel enabled by default
- [ ] Push channel shows disabled or "coming soon"

---

### TC-4.2.3: Toggle Email Notifications Off

**Steps:**
1. Log in as an employee
2. Go to notification preferences
3. Find "Shift Changes" notification
4. Toggle email OFF
5. Save preferences
6. Trigger a shift change event

**Expected Results:**
- [ ] Toggle switch changes state
- [ ] Save confirmation shown
- [ ] No email sent for shift changes
- [ ] In-app notification still received
- [ ] Preference persists after page refresh

---

### TC-4.2.4: Toggle In-App Notifications Off

**Steps:**
1. Log in as an employee
2. Go to notification preferences
3. Find "Leave Request Status" notification
4. Toggle in-app OFF
5. Save preferences
6. Get a leave request approved

**Expected Results:**
- [ ] Toggle switch changes state
- [ ] Save confirmation shown
- [ ] Email notification still sent
- [ ] No in-app notification recorded
- [ ] Preference persists on refresh

---

### TC-4.2.5: Toggle All Channels Off for One Type

**Steps:**
1. Log in as an employee
2. Go to notification preferences
3. Find "Shift Reminders" notification
4. Toggle both email and in-app OFF
5. Save preferences
6. Trigger a shift reminder event

**Expected Results:**
- [ ] Both toggles switch off
- [ ] Warning may be shown (optional)
- [ ] Save succeeds
- [ ] No notification sent via any channel
- [ ] User is effectively opted out of this type

---

### TC-4.2.6: Toggle Multiple Notification Types

**Steps:**
1. Log in as an employee
2. Go to notification preferences
3. Change multiple notification settings
4. Save all at once

**Expected Results:**
- [ ] Multiple changes can be made before saving
- [ ] Single save applies all changes
- [ ] All preferences correctly saved
- [ ] Confirmation shows all saved

---

### TC-4.2.7: Preferences Table Display

**Steps:**
1. Log in as any user
2. Go to notification preferences

**Expected Results:**
- [ ] Table shows notification types as rows
- [ ] Email column with toggle per type
- [ ] In-App column with toggle per type
- [ ] Push column (disabled/coming soon)
- [ ] Clear labels for each notification type
- [ ] Responsive on mobile devices

---

### TC-4.2.8: Preferences Persist After Logout

**Steps:**
1. Log in as an employee
2. Change notification preferences
3. Save changes
4. Log out
5. Log back in
6. Check notification preferences

**Expected Results:**
- [ ] All changed preferences still saved
- [ ] No reset to defaults on login
- [ ] Preferences stored in database correctly

---

### TC-4.2.9: Disable All Notifications

**Steps:**
1. Log in as an employee
2. Go to notification preferences
3. Toggle all email notifications OFF
4. Toggle all in-app notifications OFF
5. Save changes

**Expected Results:**
- [ ] All toggles can be turned off
- [ ] Optional warning about disabling all
- [ ] Changes save successfully
- [ ] User receives no notifications
- [ ] Can re-enable at any time

---

### TC-4.2.10: Re-Enable Notifications

**Steps:**
1. Log in as employee with all notifications disabled
2. Go to notification preferences
3. Enable email for "Shift Assignments"
4. Save changes
5. Get assigned to a new shift

**Expected Results:**
- [ ] Can toggle back on
- [ ] Save succeeds
- [ ] Email notification now sent
- [ ] Only enabled types send notifications

---

### TC-4.2.11: Admin Cannot Override User Preferences

**Steps:**
1. Employee disables email for shift changes
2. Log in as admin
3. Change an employee's shift
4. Check if employee received email

**Expected Results:**
- [ ] Employee preference is respected
- [ ] No email sent (per preference)
- [ ] Admin cannot force notifications
- [ ] System respects user choices

---

## Notes

- Verify preferences are stored per-user in database
- Test that preferences apply immediately after saving
- Check mobile responsiveness of toggle controls
- Ensure toggle states are clearly visible (on/off)
- Test with screen readers for accessibility
