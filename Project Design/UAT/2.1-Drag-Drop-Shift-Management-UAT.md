# UAT: Feature 2.1 - Drag-and-Drop Shift Management

## Test Environment Setup

**Prerequisites:**
- One admin user
- Multiple employees with assigned shifts
- Employees with different business roles
- Published and unpublished shifts on the schedule
- Access to both week and day schedule views

**Test URLs:**
- Week View: `/schedule?view=week`
- Day View: `/schedule?view=day`

---

## Test Cases

### TC-2.1.1: Drag Shift to Different Employee (Same Role)

**Steps:**
1. Log in as an admin
2. Navigate to schedule week view
3. Find a shift assigned to Employee A
4. Drag the shift to Employee B (same business role)
5. Release the shift

**Expected Results:**
- [ ] Shift block is draggable (cursor changes to grab)
- [ ] Visual drag ghost shows shift details during drag
- [ ] Drop zone highlights when hovering over valid target
- [ ] Shift is reassigned to Employee B
- [ ] Success message is displayed
- [ ] Schedule updates without full page reload

---

### TC-2.1.2: Drag Shift to Different Employee (Different Role)

**Steps:**
1. Log in as an admin
2. Navigate to schedule week view
3. Find a shift for role "Waiter"
4. Try to drag it to an employee who only has role "Chef"

**Expected Results:**
- [ ] Drop zone does NOT highlight for incompatible employee
- [ ] Shift cannot be dropped on incompatible employee
- [ ] Shift returns to original position
- [ ] Error message explains role incompatibility

---

### TC-2.1.3: Drag Shift to Different Day (Same Employee)

**Steps:**
1. Log in as an admin
2. Navigate to schedule week view
3. Find a shift on Monday for Employee A
4. Drag it to Tuesday for the same employee

**Expected Results:**
- [ ] Shift moves to the new day
- [ ] Start and end times remain the same
- [ ] Shift is now on Tuesday
- [ ] Original Monday slot is empty

---

### TC-2.1.4: Visual Feedback During Drag

**Steps:**
1. Log in as an admin
2. Navigate to schedule week view
3. Start dragging a shift
4. Observe the visual feedback

**Expected Results:**
- [ ] Drag ghost shows shift information (time, role)
- [ ] Original shift location shows placeholder/outline
- [ ] Valid drop zones are highlighted
- [ ] Invalid drop zones are not highlighted or shown differently
- [ ] Cursor indicates drag operation

---

### TC-2.1.5: Conflict Detection During Drag

**Steps:**
1. Log in as an admin
2. Navigate to schedule week view
3. Ensure Employee B already has a shift 09:00-17:00 on Tuesday
4. Try to drag a conflicting shift (10:00-14:00) to Employee B on Tuesday

**Expected Results:**
- [ ] Conflict is detected
- [ ] Drop is prevented OR warning is shown
- [ ] Shift returns to original position if drop is prevented
- [ ] Clear error message about overlapping shifts

---

### TC-2.1.6: Drag-and-Drop on Day View

**Steps:**
1. Log in as an admin
2. Navigate to schedule day view
3. Find a shift and drag it to a different employee row

**Expected Results:**
- [ ] Drag-and-drop works on day view
- [ ] Visual feedback is appropriate for day view layout
- [ ] Shift reassignment succeeds
- [ ] Timeline view updates correctly

---

### TC-2.1.7: Resize Shift on Day View (Start Time)

**Steps:**
1. Log in as an admin
2. Navigate to schedule day view
3. Hover over the top edge of a shift block
4. Drag the top edge to an earlier time

**Expected Results:**
- [ ] Cursor changes to resize cursor on top edge
- [ ] Dragging extends shift start time
- [ ] Visual preview shows new time range
- [ ] On release, shift time is updated
- [ ] Shift displays new start time

---

### TC-2.1.8: Resize Shift on Day View (End Time)

**Steps:**
1. Log in as an admin
2. Navigate to schedule day view
3. Hover over the bottom edge of a shift block
4. Drag the bottom edge to a later time

**Expected Results:**
- [ ] Cursor changes to resize cursor on bottom edge
- [ ] Dragging extends shift end time
- [ ] Visual preview shows new time range
- [ ] On release, shift time is updated
- [ ] Shift displays new end time

---

### TC-2.1.9: Employee Cannot Drag Shifts

**Steps:**
1. Log in as an employee (non-admin)
2. Navigate to schedule view
3. Try to drag your own shift

**Expected Results:**
- [ ] Shifts are NOT draggable for employees
- [ ] Cursor does not change to grab
- [ ] No drag operation initiates

---

### TC-2.1.10: Undo Drag Operation

**Steps:**
1. Log in as an admin
2. Drag a shift to a new position
3. Look for undo option or use Ctrl+Z

**Expected Results:**
- [ ] Undo option is available (toast message or keyboard)
- [ ] Clicking undo reverts the shift to original position
- [ ] OR if no undo, changes persist and can be manually reverted

---

### TC-2.1.11: Draft Shift Drag-and-Drop

**Steps:**
1. Log in as an admin
2. Create a draft (unpublished) shift
3. Drag the draft shift to a different position

**Expected Results:**
- [ ] Draft shifts can be dragged
- [ ] Draft visual styling is maintained after move
- [ ] Shift remains in draft status

---

### TC-2.1.12: Multiple Quick Drags

**Steps:**
1. Log in as an admin
2. Quickly drag and drop 3-4 shifts in succession
3. Do not wait for page reloads between drags

**Expected Results:**
- [ ] All drag operations complete successfully
- [ ] No race conditions or errors
- [ ] All shifts are in their new positions
- [ ] Schedule state is consistent

---

### TC-2.1.13: Mobile/Touch Drag Support

**Steps:**
1. Log in as an admin on a tablet or touch device
2. Navigate to schedule view
3. Long-press on a shift to initiate drag
4. Drag to new position

**Expected Results:**
- [ ] Touch drag is supported (or gracefully disabled)
- [ ] If supported, same behavior as mouse drag
- [ ] No accidental drags from regular taps

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test on different browsers (Chrome, Firefox, Safari, Edge)
