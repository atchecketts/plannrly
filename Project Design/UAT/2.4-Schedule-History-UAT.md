# UAT: Feature 2.4 - Schedule History / Version Control

## Test Environment Setup

**Prerequisites:**
- One admin user
- One employee user
- Existing shifts with recorded history
- Multiple schedule modifications made previously

**Test URLs:**
- Schedule: `/schedule`
- History: `/schedule/history`

---

## Test Cases

### TC-2.4.1: View Schedule History Page

**Steps:**
1. Log in as an admin
2. Navigate to Schedule
3. Click "View History" button or navigate to history page

**Expected Results:**
- [ ] History page loads successfully
- [ ] Shows timeline of schedule changes
- [ ] Changes are ordered chronologically (newest first)
- [ ] "View History" button is visible on schedule

---

### TC-2.4.2: Shift Creation Logged

**Steps:**
1. Log in as an admin
2. Create a new shift
3. Navigate to schedule history

**Expected Results:**
- [ ] New entry shows "Shift Created"
- [ ] Entry shows who created the shift
- [ ] Entry shows timestamp
- [ ] Entry shows shift details (employee, date, times)

---

### TC-2.4.3: Shift Update Logged

**Steps:**
1. Log in as an admin
2. Edit an existing shift (change time or employee)
3. Navigate to schedule history

**Expected Results:**
- [ ] New entry shows "Shift Updated"
- [ ] Entry shows what was changed (old vs new values)
- [ ] Entry shows who made the change
- [ ] Entry shows timestamp

---

### TC-2.4.4: Shift Deletion Logged

**Steps:**
1. Log in as an admin
2. Delete an existing shift
3. Navigate to schedule history

**Expected Results:**
- [ ] New entry shows "Shift Deleted"
- [ ] Entry shows the deleted shift details
- [ ] Entry shows who deleted it
- [ ] Entry shows timestamp

---

### TC-2.4.5: Shift Reassignment Logged (Drag-Drop)

**Steps:**
1. Log in as an admin
2. Drag a shift from Employee A to Employee B
3. Navigate to schedule history

**Expected Results:**
- [ ] Entry shows "Shift Reassigned"
- [ ] Shows previous employee and new employee
- [ ] Records method (drag-drop if tracked)
- [ ] Timestamp recorded

---

### TC-2.4.6: Filter History by Date Range

**Steps:**
1. Log in as an admin
2. Navigate to schedule history
3. Set date range filter (e.g., last 7 days)
4. Apply filter

**Expected Results:**
- [ ] Only changes within date range shown
- [ ] Date picker is functional
- [ ] Clear filter option available
- [ ] Count of results displayed

---

### TC-2.4.7: Filter History by Employee

**Steps:**
1. Log in as an admin
2. Navigate to schedule history
3. Filter by specific employee
4. Apply filter

**Expected Results:**
- [ ] Only changes affecting that employee shown
- [ ] Employee dropdown lists all employees
- [ ] Combined with date filter works
- [ ] Clear filter resets view

---

### TC-2.4.8: Filter History by Action Type

**Steps:**
1. Log in as an admin
2. Navigate to schedule history
3. Filter by action type (e.g., "Created" or "Deleted")
4. Apply filter

**Expected Results:**
- [ ] Only selected action types shown
- [ ] Can select multiple action types
- [ ] Filter combines with other filters
- [ ] Results update accordingly

---

### TC-2.4.9: History Entry Details

**Steps:**
1. Log in as an admin
2. Navigate to schedule history
3. Click on a history entry to expand details

**Expected Results:**
- [ ] Full details of the change shown
- [ ] Shows all changed fields
- [ ] Shows old and new values for updates
- [ ] Shows user who made change
- [ ] Shows exact timestamp

---

### TC-2.4.10: Employee Cannot Access Full History

**Steps:**
1. Log in as an employee
2. Try to navigate to `/schedule/history`

**Expected Results:**
- [ ] Access denied (403) OR
- [ ] Employee sees only their own shift history
- [ ] Cannot see other employees' shift changes

---

### TC-2.4.11: Bulk Action History

**Steps:**
1. Log in as an admin
2. Perform a bulk action (e.g., publish multiple shifts)
3. Navigate to schedule history

**Expected Results:**
- [ ] Bulk action is logged
- [ ] Shows count of affected shifts
- [ ] May show individual entries or grouped entry
- [ ] Action type clearly identified

---

### TC-2.4.12: History Pagination

**Steps:**
1. Log in as an admin
2. Navigate to schedule history with many entries
3. Scroll or navigate through pages

**Expected Results:**
- [ ] History is paginated (not infinite scroll crash)
- [ ] Page navigation works
- [ ] Can jump to specific page
- [ ] Performance is acceptable

---

### TC-2.4.13: Export History Report

**Steps:**
1. Log in as an admin
2. Navigate to schedule history
3. Apply desired filters
4. Click "Export" or "Download" button

**Expected Results:**
- [ ] Export option is available
- [ ] Can export to CSV or PDF
- [ ] Export includes filtered data
- [ ] Export includes all relevant fields

---

### TC-2.4.14: History Shows Swap Events

**Steps:**
1. Complete a shift swap between two employees
2. Navigate to schedule history

**Expected Results:**
- [ ] Swap event is logged
- [ ] Shows both employees involved
- [ ] Shows which shifts were swapped
- [ ] Shows swap approval status

---

### TC-2.4.15: Tenant Isolation in History

**Steps:**
1. Log in as admin of Tenant A
2. Make schedule changes
3. Log in as admin of Tenant B
4. View schedule history

**Expected Results:**
- [ ] Tenant B cannot see Tenant A's history
- [ ] History is scoped to current tenant
- [ ] No data leakage between tenants

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Verify audit trail meets compliance requirements
