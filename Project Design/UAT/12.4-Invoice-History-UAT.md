# UAT: Feature 12.4 - Invoice & Billing History

## Test Environment Setup

**Prerequisites:**
- Stripe test mode configured
- Tenant with active subscription and payment history
- At least 2-3 invoices generated (from subscription cycles)
- Access to download PDF files

**Test URLs:**
- Invoice List: `/subscription/invoices`
- Invoice Download: `/subscription/invoices/{id}/download`

---

## Test Cases

### TC-12.4.1: Invoice Page Loads

**Steps:**
1. Log in as tenant with subscription history
2. Navigate to invoices page

**Expected Results:**
- [ ] Page loads without errors
- [ ] Invoice list displayed
- [ ] Page accessible from subscription section

---

### TC-12.4.2: Invoice List Displays Correctly

**Steps:**
1. Navigate to invoices page
2. Review the invoice list

**Expected Results:**
- [ ] All invoices listed
- [ ] Date column shows invoice date
- [ ] Invoice number/ID shown
- [ ] Amount shown with currency
- [ ] Status shown (Paid, Unpaid, etc.)

---

### TC-12.4.3: Invoice Status Indicators

**Steps:**
1. Navigate to invoices page
2. Check invoices with different statuses

**Expected Results:**
- [ ] Paid invoices show green/success indicator
- [ ] Unpaid invoices show red/warning indicator
- [ ] Status text is clear (Paid, Unpaid, Pending)
- [ ] Status visually distinct

---

### TC-12.4.4: Invoice Details View

**Steps:**
1. Navigate to invoices page
2. Click on an invoice to view details

**Expected Results:**
- [ ] Invoice details page loads
- [ ] Invoice number displayed
- [ ] Date displayed
- [ ] Line items shown
- [ ] Subtotal, tax, total shown
- [ ] Customer details displayed

---

### TC-12.4.5: Download Invoice PDF

**Steps:**
1. Navigate to invoices page
2. Click "Download PDF" on an invoice
3. Save/open the file

**Expected Results:**
- [ ] PDF downloads successfully
- [ ] PDF opens correctly
- [ ] Contains company details (Checketts Propiedad SL)
- [ ] Contains invoice number
- [ ] Contains line items and amounts
- [ ] Contains tax information
- [ ] Professional appearance

---

### TC-12.4.6: PDF Invoice Content

**Steps:**
1. Download an invoice PDF
2. Verify content details

**Expected Results:**
- [ ] Vendor: Checketts Propiedad SL
- [ ] Tax ID: ESB42691550
- [ ] Address displayed
- [ ] Product: Plannrly Subscription
- [ ] Customer name and email
- [ ] Amounts correct

---

### TC-12.4.7: Upcoming Invoice Preview

**Steps:**
1. Navigate to invoices page
2. Look for upcoming invoice section

**Expected Results:**
- [ ] Upcoming invoice shown (if applicable)
- [ ] Due date displayed
- [ ] Amount due shown
- [ ] Clear this is a preview/estimate

---

### TC-12.4.8: Empty Invoice History

**Steps:**
1. Log in as new tenant without invoices
2. Navigate to invoices page

**Expected Results:**
- [ ] Empty state message displayed
- [ ] No error shown
- [ ] Message like "No invoices yet"
- [ ] Clear navigation to subscribe

---

### TC-12.4.9: Invoice Pagination

**Steps:**
1. Have tenant with many invoices (10+)
2. Navigate to invoices page
3. Check pagination

**Expected Results:**
- [ ] Invoices paginated (10-20 per page)
- [ ] Pagination controls work
- [ ] Can navigate between pages
- [ ] Newest first by default

---

### TC-12.4.10: Invoice Date Formatting

**Steps:**
1. Navigate to invoices page
2. Check date formats

**Expected Results:**
- [ ] Dates formatted consistently
- [ ] User-friendly format (Jan 15, 2026)
- [ ] Timezone appropriate

---

### TC-12.4.11: Invoice Amount Formatting

**Steps:**
1. Navigate to invoices page
2. Check amount displays

**Expected Results:**
- [ ] Currency symbol shown
- [ ] Amounts properly formatted
- [ ] Decimal places consistent
- [ ] Large amounts readable (thousands separators)

---

### TC-12.4.12: Mobile Invoice View

**Steps:**
1. Access invoices page on mobile
2. View list and download PDF

**Expected Results:**
- [ ] List readable on mobile
- [ ] Table responsive or card layout
- [ ] Download works on mobile
- [ ] PDF viewable on mobile

---

## Notes

- Test PDF download in different browsers
- Verify PDF opens in default PDF viewer
- Check that no sensitive data exposed
- Test with invoices of various amounts
- Verify proration invoices display correctly
