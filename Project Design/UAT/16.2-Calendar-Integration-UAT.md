# UAT: Feature 16.2 - Calendar Integration

## Test Environment Setup

**Prerequisites:**
- Employee user account with assigned shifts
- Personal calendar application (Google Calendar, Apple Calendar, Outlook)
- Published shifts for testing

**Test URL:** `/settings/calendar-sync`

---

## Test Cases

### TC-16.2.1: Access Calendar Sync Settings

**Steps:**
1. Log in as an employee
2. Navigate to account settings
3. Click on "Calendar Sync" or "Calendar Integration"

**Expected Results:**
- [ ] Calendar sync settings page loads
- [ ] Current sync status shown
- [ ] Option to generate/view feed URL
- [ ] Instructions for adding to calendar apps

---

### TC-16.2.2: Generate iCal Feed URL

**Steps:**
1. Navigate to calendar sync settings
2. Click "Generate Feed URL" or "Enable Calendar Sync"

**Expected Results:**
- [ ] Unique iCal feed URL is generated
- [ ] URL contains secure token
- [ ] URL is displayed for copying
- [ ] URL follows iCal/webcal format

---

### TC-16.2.3: Copy Feed URL

**Steps:**
1. Generate or view iCal feed URL
2. Click "Copy" button

**Expected Results:**
- [ ] URL is copied to clipboard
- [ ] Confirmation shown (tooltip or message)
- [ ] URL can be pasted in calendar app

---

### TC-16.2.4: Add Feed to Google Calendar

**Steps:**
1. Copy the iCal feed URL
2. Open Google Calendar
3. Add calendar from URL
4. Paste the feed URL
5. Subscribe to the calendar

**Expected Results:**
- [ ] Google Calendar accepts the URL
- [ ] Calendar is added successfully
- [ ] Shifts appear in the calendar
- [ ] Calendar name is appropriate

---

### TC-16.2.5: Add Feed to Apple Calendar

**Steps:**
1. Copy the iCal feed URL
2. Open Apple Calendar
3. File > New Calendar Subscription
4. Paste the URL
5. Subscribe

**Expected Results:**
- [ ] Apple Calendar accepts the URL
- [ ] Subscription is created
- [ ] Shifts appear correctly
- [ ] Refresh interval is set

---

### TC-16.2.6: Add Feed to Outlook

**Steps:**
1. Copy the iCal feed URL
2. Open Outlook calendar
3. Add calendar from internet
4. Paste the URL

**Expected Results:**
- [ ] Outlook accepts the URL
- [ ] Calendar is added
- [ ] Shifts display correctly
- [ ] Calendar auto-refreshes

---

### TC-16.2.7: Shift Details in Calendar Events

**Steps:**
1. Subscribe to calendar feed
2. View a shift event in the calendar

**Expected Results:**
- [ ] Event title shows shift information
- [ ] Start and end times are correct
- [ ] Location is included
- [ ] Business role is shown
- [ ] Any notes are included

---

### TC-16.2.8: Calendar Updates When Schedule Changes

**Steps:**
1. Subscribe to calendar feed
2. Have admin modify a shift (change time)
3. Wait for calendar to refresh
4. Verify the change is reflected

**Expected Results:**
- [ ] Changed shift updates in calendar
- [ ] No duplicate events created
- [ ] Timing depends on calendar refresh rate
- [ ] Deleted shifts are removed

---

### TC-16.2.9: Only User's Shifts in Feed

**Steps:**
1. Subscribe to calendar feed
2. Verify only your shifts appear
3. Compare with colleague's calendar

**Expected Results:**
- [ ] Feed contains only the user's shifts
- [ ] No other employees' shifts visible
- [ ] Privacy maintained

---

### TC-16.2.10: Regenerate Feed URL

**Steps:**
1. Navigate to calendar sync settings
2. Click "Regenerate URL" or "Reset Feed"
3. Confirm the action

**Expected Results:**
- [ ] New URL is generated
- [ ] Old URL stops working
- [ ] Warning about re-subscribing shown
- [ ] Security is maintained

---

### TC-16.2.11: Old URL Stops Working

**Steps:**
1. Copy the current feed URL
2. Regenerate the URL
3. Try to access the old URL

**Expected Results:**
- [ ] Old URL returns error/empty
- [ ] Calendar apps show error or no events
- [ ] User must re-subscribe with new URL

---

### TC-16.2.12: Feed URL Security

**Steps:**
1. Try to access feed URL without token
2. Try to modify the URL to access others' feeds

**Expected Results:**
- [ ] URL requires valid token
- [ ] Cannot guess other users' URLs
- [ ] Unauthorized access rejected
- [ ] No personal data leaked

---

### TC-16.2.13: ICS Format Compliance

**Steps:**
1. Download the feed directly (not via calendar app)
2. Examine the ICS file contents

**Expected Results:**
- [ ] Valid ICS format
- [ ] Proper VCALENDAR structure
- [ ] VEVENT for each shift
- [ ] Timezone handled correctly

---

### TC-16.2.14: Calendar Feed Instructions

**Steps:**
1. Navigate to calendar sync settings
2. Review the setup instructions

**Expected Results:**
- [ ] Instructions for major calendar apps provided
- [ ] Step-by-step guidance available
- [ ] Screenshots or links to help articles
- [ ] Troubleshooting tips included

---

### TC-16.2.15: Disable Calendar Sync

**Steps:**
1. Navigate to calendar sync settings
2. Click "Disable" or "Stop Syncing"
3. Confirm the action

**Expected Results:**
- [ ] Feed is disabled
- [ ] URL stops working
- [ ] User can re-enable later
- [ ] Calendar apps will fail to refresh

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test with multiple calendar applications
