# UAT: Feature 14.3 - Audit Log System

## Test Environment Setup

**Prerequisites:**
- Admin user account
- Employee user account
- Various entities to perform actions on (users, shifts, leave requests)
- Existing audit log entries

**Test URL:** `/audit-logs`

---

## Test Cases

### TC-14.3.1: Access Audit Log (Admin)

**Steps:**
1. Log in as an admin
2. Navigate to "Audit Logs" in the sidebar

**Expected Results:**
- [ ] Audit log page loads successfully
- [ ] Recent audit entries are displayed
- [ ] Columns show: Date, User, Action, Entity, Details

---

### TC-14.3.2: Employee Cannot Access Audit Log

**Steps:**
1. Log in as an employee
2. Try to navigate to `/audit-logs` directly

**Expected Results:**
- [ ] Access is denied (403 error)
- [ ] Audit logs link not visible in sidebar
- [ ] No audit data exposed

---

### TC-14.3.3: Audit Entry Created on User Creation

**Steps:**
1. Log in as admin
2. Create a new user
3. Navigate to audit logs
4. Find the entry for user creation

**Expected Results:**
- [ ] Audit entry exists for user creation
- [ ] Shows admin who created the user
- [ ] Shows "Created" action type
- [ ] Shows user entity details

---

### TC-14.3.4: Audit Entry Created on User Update

**Steps:**
1. Log in as admin
2. Update an existing user's details
3. Navigate to audit logs
4. Find the entry for user update

**Expected Results:**
- [ ] Audit entry exists for user update
- [ ] Shows "Updated" action type
- [ ] Shows what fields were changed
- [ ] Old and new values recorded

---

### TC-14.3.5: Audit Entry Created on User Deletion

**Steps:**
1. Log in as admin
2. Delete a user
3. Navigate to audit logs
4. Find the entry for user deletion

**Expected Results:**
- [ ] Audit entry exists for user deletion
- [ ] Shows "Deleted" action type
- [ ] Shows who performed the deletion
- [ ] Deleted user details preserved

---

### TC-14.3.6: Audit Entry for Shift Actions

**Steps:**
1. Log in as admin
2. Create, update, and delete shifts
3. Navigate to audit logs
4. Find entries for shift actions

**Expected Results:**
- [ ] Create shift logged
- [ ] Update shift logged with changes
- [ ] Delete shift logged
- [ ] Shift details captured

---

### TC-14.3.7: Audit Entry for Leave Request Actions

**Steps:**
1. Log in as admin
2. Approve or reject a leave request
3. Navigate to audit logs
4. Find the entry

**Expected Results:**
- [ ] Leave request action logged
- [ ] Shows approval/rejection action
- [ ] Shows who made the decision
- [ ] Leave request details included

---

### TC-14.3.8: Filter Audit Logs by User

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Filter by a specific user

**Expected Results:**
- [ ] User filter dropdown/search available
- [ ] Results show only selected user's actions
- [ ] Clear filter option available
- [ ] Filter persists across pagination

---

### TC-14.3.9: Filter Audit Logs by Action Type

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Filter by action type (Create/Update/Delete)

**Expected Results:**
- [ ] Action type filter available
- [ ] Results show only selected action type
- [ ] Multiple action types can be selected
- [ ] Filter works correctly

---

### TC-14.3.10: Filter Audit Logs by Entity Type

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Filter by entity type (User, Shift, LeaveRequest, etc.)

**Expected Results:**
- [ ] Entity type filter available
- [ ] Results show only selected entity type
- [ ] All auditable entities are options
- [ ] Filter works correctly

---

### TC-14.3.11: Filter Audit Logs by Date Range

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Set a date range filter (e.g., last 7 days)

**Expected Results:**
- [ ] Date range picker available
- [ ] Results limited to selected range
- [ ] Start and end dates work correctly
- [ ] Invalid ranges show error

---

### TC-14.3.12: Search Audit Logs

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Search for specific text (user name, entity ID, etc.)

**Expected Results:**
- [ ] Search box available
- [ ] Results match search term
- [ ] Search covers relevant fields
- [ ] No results shows appropriate message

---

### TC-14.3.13: View Audit Entry Details

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Click on an audit entry for details

**Expected Results:**
- [ ] Detail view or modal opens
- [ ] Shows full entry information
- [ ] Shows old vs new values for updates
- [ ] IP address and browser info shown

---

### TC-14.3.14: Export Audit Logs to CSV

**Steps:**
1. Log in as admin
2. Navigate to audit logs
3. Apply some filters
4. Click "Export" or "Download CSV"

**Expected Results:**
- [ ] Export button available
- [ ] CSV file downloads
- [ ] Export respects current filters
- [ ] All relevant columns included

---

### TC-14.3.15: Audit Log Retention

**Steps:**
1. Check audit log retention configuration
2. Verify old logs are handled per policy

**Expected Results:**
- [ ] Retention period is configurable per tenant
- [ ] Old logs archived or deleted per policy
- [ ] No unexpected data loss
- [ ] Compliance requirements met

---

### TC-14.3.16: Audit Logs Are Immutable

**Steps:**
1. Attempt to modify an audit log entry (via any means)
2. Verify logs cannot be altered

**Expected Results:**
- [ ] No edit functionality for audit logs
- [ ] Database constraints prevent modification
- [ ] Audit integrity maintained
- [ ] Deletion only via retention policy

---

### TC-14.3.17: Pagination of Audit Logs

**Steps:**
1. Generate many audit entries
2. Navigate to audit logs
3. Use pagination controls

**Expected Results:**
- [ ] Pagination works correctly
- [ ] Page size is reasonable
- [ ] Can navigate to different pages
- [ ] Total count displayed

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Verify audit logs capture sensitive action changes appropriately
