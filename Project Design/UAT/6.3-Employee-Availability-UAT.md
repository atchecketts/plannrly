# UAT: Feature 6.3 - Employee Availability Management

## Test Environment Setup

**Prerequisites:**
- Multiple employee users
- One admin user
- Schedule with shifts that can be assigned
- Different business roles configured
- Calendar component accessible

**Test URL:** `/availability` (Employee), `/users/{id}/availability` (Admin)

---

## Test Cases

### TC-6.3.1: View Availability Page (Employee)

**Steps:**
1. Log in as an employee
2. Navigate to "My Availability" in the sidebar or profile

**Expected Results:**
- [ ] Availability page loads successfully
- [ ] Shows current availability settings
- [ ] Displays weekly recurring availability
- [ ] Shows specific date exceptions
- [ ] Edit options are available

---

### TC-6.3.2: View Employee Availability (Admin)

**Steps:**
1. Log in as an admin
2. Navigate to an employee's profile
3. Click on "Availability" tab or section

**Expected Results:**
- [ ] Admin can view employee's availability
- [ ] All availability rules are displayed
- [ ] Can edit on behalf of employee
- [ ] Shows same information as employee sees

---

### TC-6.3.3: Set Recurring Weekly Availability

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Set recurring availability for Monday (9am - 5pm)
4. Set recurring availability for Tuesday-Friday (9am - 5pm)
5. Mark Saturday and Sunday as unavailable
6. Save changes

**Expected Results:**
- [ ] Can select days of the week
- [ ] Can set start and end times per day
- [ ] Multiple time blocks per day possible
- [ ] Unavailable days are marked correctly
- [ ] Settings save successfully

---

### TC-6.3.4: Set Preference Levels

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Set Monday as "Preferred" availability
4. Set Wednesday as "Available"
5. Set Thursday as "If Needed"
6. Set Friday as "Unavailable"
7. Save changes

**Expected Results:**
- [ ] Four preference levels are available
- [ ] Preferred shows strongest preference
- [ ] Available shows general availability
- [ ] If Needed shows reluctant availability
- [ ] Unavailable shows not available
- [ ] Color coding distinguishes levels

---

### TC-6.3.5: Mark Specific Date as Unavailable

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Click "Add Date Exception" or similar
4. Select a specific date (e.g., next Friday)
5. Mark as "Unavailable"
6. Add optional note (e.g., "Doctor appointment")
7. Save

**Expected Results:**
- [ ] Date picker allows selecting future dates
- [ ] Can mark single date as unavailable
- [ ] Note field accepts text
- [ ] Exception is saved and displayed
- [ ] Overrides recurring availability for that day

---

### TC-6.3.6: Set Date Range Exception

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Create an exception for a date range (e.g., Dec 20-31)
4. Mark as "Unavailable"
5. Add note (e.g., "Holiday travel")
6. Save

**Expected Results:**
- [ ] Can select start and end dates
- [ ] Range is saved correctly
- [ ] All dates in range show as unavailable
- [ ] Displays clearly in availability list

---

### TC-6.3.7: Set Effective Date Range for Recurring

**Steps:**
1. Log in as an employee
2. Create recurring availability rule
3. Set "Effective From" date (e.g., next month)
4. Set "Effective Until" date (e.g., 3 months out)
5. Save

**Expected Results:**
- [ ] Can set when rule becomes active
- [ ] Can set when rule expires
- [ ] Rule only applies within date range
- [ ] Old rules remain for historical reference

---

### TC-6.3.8: Visual Calendar Display

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. View the calendar component

**Expected Results:**
- [ ] Calendar shows current month
- [ ] Can navigate to future months
- [ ] Days are color-coded by availability
- [ ] Clicking a day shows details
- [ ] Legend explains color meanings

---

### TC-6.3.9: Availability Warnings on Schedule

**Steps:**
1. Log in as an admin
2. Navigate to Schedule
3. Attempt to assign a shift to an employee marked as unavailable
4. View any warnings displayed

**Expected Results:**
- [ ] Warning indicator shows availability conflict
- [ ] Can still assign if desired (not blocked, just warned)
- [ ] Warning shows the preference level
- [ ] Tooltip or modal explains the conflict

---

### TC-6.3.10: Delete Recurring Availability Rule

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Find an existing recurring rule
4. Click "Delete" or remove button
5. Confirm deletion

**Expected Results:**
- [ ] Confirmation prompt before deletion
- [ ] Rule is removed
- [ ] Calendar updates to reflect removal
- [ ] Days revert to default (available or parent rule)

---

### TC-6.3.11: Delete Date Exception

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Find a specific date exception
4. Delete the exception
5. Confirm

**Expected Results:**
- [ ] Exception is removed
- [ ] Date reverts to recurring availability
- [ ] Calendar display updates
- [ ] Success message shown

---

### TC-6.3.12: Edit Existing Availability Rule

**Steps:**
1. Log in as an employee
2. Navigate to availability settings
3. Click edit on an existing recurring rule
4. Change the time range
5. Save changes

**Expected Results:**
- [ ] Edit form shows current values
- [ ] Can modify times and preference
- [ ] Changes save successfully
- [ ] Updated rule is displayed

---

### TC-6.3.13: Overlap Validation

**Steps:**
1. Log in as an employee
2. Create a recurring rule for Monday 9am-5pm
3. Attempt to create another rule for Monday 12pm-6pm
4. Check validation

**Expected Results:**
- [ ] System detects overlapping time blocks
- [ ] Warning or error is shown
- [ ] User must resolve overlap
- [ ] Or overlap is merged/handled gracefully

---

### TC-6.3.14: Past Date Restrictions

**Steps:**
1. Log in as an employee
2. Attempt to set availability for a past date
3. Check validation

**Expected Results:**
- [ ] Cannot set future availability for past dates
- [ ] Date picker may restrict selection
- [ ] Clear message if past date is attempted
- [ ] Historical data is preserved read-only

---

### TC-6.3.15: Availability for AI Scheduling Integration

**Steps:**
1. Log in as an admin
2. Set up employees with varying availability
3. Use AI scheduling to auto-assign shifts
4. Check if availability is respected

**Expected Results:**
- [ ] AI scheduling reads availability data
- [ ] Unavailable times are not assigned
- [ ] Preference levels influence assignment priority
- [ ] "If Needed" slots used only when necessary

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test calendar navigation and date selection
- Verify timezone handling for availability times
