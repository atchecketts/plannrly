# UAT: Feature 7.1 - AI Scheduling Service Core

## Test Environment Setup

**Prerequisites:**
- Admin user with AI Scheduling feature enabled (Premium add-on)
- Multiple employees with:
  - Different business roles
  - Configured availability (recurring and exceptions)
  - Target hours per week set
  - Min/max hours per week configured
- Various shifts to be assigned (unassigned)
- Some employees with approved leave during test period
- Active and inactive employees for testing constraints

**Test URL:** N/A (Backend service - tested via UI in 7.2)

---

## Test Cases

### TC-7.1.1: Hard Constraint - Role Qualification

**Steps:**
1. Create shifts requiring "Cashier" role
2. Have employees: one with Cashier role, one without
3. Run AI scheduling for these shifts
4. Check assignments

**Expected Results:**
- [ ] Only employees with required role are assigned
- [ ] Employees without role are never suggested
- [ ] System enforces role requirement absolutely
- [ ] Warning if no qualified employees available

---

### TC-7.1.2: Hard Constraint - Availability Check

**Steps:**
1. Set Employee A as unavailable on Monday
2. Create shift for Monday
3. Run AI scheduling
4. Check if Employee A is assigned

**Expected Results:**
- [ ] Employee A is NOT assigned to Monday shift
- [ ] Available employees are considered instead
- [ ] Unavailable constraint is never violated
- [ ] Works with both recurring and date-specific unavailability

---

### TC-7.1.3: Hard Constraint - Not On Leave

**Steps:**
1. Create approved leave request for Employee B on Tuesday
2. Create shift for Tuesday
3. Run AI scheduling
4. Check if Employee B is assigned

**Expected Results:**
- [ ] Employee B is NOT assigned during approved leave
- [ ] System checks leave status before assignment
- [ ] Pending leave may show as warning only
- [ ] Leave dates are fully blocked

---

### TC-7.1.4: Hard Constraint - No Overlap

**Steps:**
1. Assign Employee C to shift 9am-1pm on Wednesday
2. Create another shift 12pm-4pm on Wednesday
3. Run AI scheduling for second shift
4. Check if Employee C is suggested

**Expected Results:**
- [ ] Employee C is NOT assigned to overlapping shift
- [ ] System detects time overlap correctly
- [ ] Other available employees are suggested
- [ ] Overlap constraint cannot be violated

---

### TC-7.1.5: Hard Constraint - Active Employment

**Steps:**
1. Set Employee D employment status to "Terminated"
2. Create shifts and run AI scheduling
3. Check if Employee D appears in suggestions

**Expected Results:**
- [ ] Terminated employees are never assigned
- [ ] "On Leave" status employees may be blocked
- [ ] Only "Active" employees are scheduled
- [ ] Status is checked for all suggestions

---

### TC-7.1.6: Hard Constraint - Max Hours Per Week

**Steps:**
1. Set Employee E max hours to 20 per week
2. Already schedule Employee E for 18 hours
3. Create 8-hour shift and run AI scheduling
4. Check if Employee E is suggested

**Expected Results:**
- [ ] Employee E is NOT assigned (would exceed max)
- [ ] System calculates weekly hours before suggesting
- [ ] Shorter shifts may still be assigned if under max
- [ ] Week boundary is handled correctly (Mon-Sun)

---

### TC-7.1.7: Soft Constraint - Target Hours

**Steps:**
1. Set Employee F target hours to 30 per week
2. Employee F currently has 20 hours scheduled
3. Set Employee G target hours to 40, currently at 38 hours
4. Run AI scheduling for available shift

**Expected Results:**
- [ ] Employee F (further from target) is preferred
- [ ] Scoring favors employees who need more hours
- [ ] Target hours influence but don't absolutely determine
- [ ] Explanation shows target hours consideration

---

### TC-7.1.8: Soft Constraint - Preference Level

**Steps:**
1. Set Employee H availability for Monday as "Preferred"
2. Set Employee I availability for Monday as "If Needed"
3. Both employees have same role and no hard constraints
4. Run AI scheduling for Monday shift

**Expected Results:**
- [ ] Employee H is ranked higher (preferred availability)
- [ ] Employee I is considered but lower score
- [ ] Preference level affects ranking order
- [ ] "Available" falls between Preferred and If Needed

---

### TC-7.1.9: Soft Constraint - Fair Distribution

**Steps:**
1. Have 5 employees with same role, all available
2. Create 10 similar shifts across the week
3. Run AI scheduling
4. Check distribution of assignments

**Expected Results:**
- [ ] Hours are distributed relatively evenly
- [ ] No single employee gets majority of shifts
- [ ] Distribution considers existing assignments
- [ ] Fairness balances with other constraints

---

### TC-7.1.10: Soft Constraint - Minimize Overtime

**Steps:**
1. Set Employee J target hours to 40 per week
2. Already schedule Employee J for 40 hours
3. Run AI scheduling for additional shift
4. Check scoring and assignment

**Expected Results:**
- [ ] Employee J is deprioritized (already at target)
- [ ] System prefers employees under their target
- [ ] Overtime is assigned only when necessary
- [ ] Score breakdown shows overtime penalty

---

### TC-7.1.11: Soft Constraint - Consecutive Shifts

**Steps:**
1. Have Employee K working Mon, Tue, Wed
2. Create shift for Thursday
3. Run AI scheduling
4. Check if consecutive shift grouping is considered

**Expected Results:**
- [ ] Employee K may get slight preference for Thursday
- [ ] Grouping helps reduce fragmentated schedules
- [ ] Does not override more important constraints
- [ ] Balance with fair distribution is maintained

---

### TC-7.1.12: No Qualified Employees Available

**Steps:**
1. Create shift requiring "Manager" role
2. Ensure no managers are available (on leave or unavailable)
3. Run AI scheduling

**Expected Results:**
- [ ] System reports no candidates available
- [ ] Does not assign unqualified employees
- [ ] Clear warning message about unfillable shift
- [ ] Suggests possible resolution (manual assignment)

---

### TC-7.1.13: Multiple Shifts Optimization

**Steps:**
1. Create 20 unassigned shifts across one week
2. Have 8 employees with varying constraints
3. Run AI scheduling for all shifts
4. Review overall assignment quality

**Expected Results:**
- [ ] All fillable shifts are assigned
- [ ] Hard constraints are never violated
- [ ] Soft constraints are balanced across schedule
- [ ] Overall schedule quality score is provided

---

### TC-7.1.14: Schedule Context State

**Steps:**
1. Start AI scheduling process
2. Monitor how the algorithm tracks state
3. Check that assignments accumulate correctly

**Expected Results:**
- [ ] Each assignment updates available hours tracking
- [ ] Subsequent suggestions reflect prior assignments
- [ ] Weekly hours are accumulated correctly
- [ ] Context prevents double-booking during run

---

### TC-7.1.15: Schedule Quality Metrics

**Steps:**
1. Run AI scheduling on a schedule
2. Request schedule analysis/quality metrics
3. Review the quality score

**Expected Results:**
- [ ] Overall quality score is calculated (0-100 or similar)
- [ ] Breakdown shows individual constraint satisfaction
- [ ] Identifies areas for improvement
- [ ] Metrics help evaluate schedule fairness

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test with edge cases (single employee, max constraints)
- Verify algorithm performance with larger datasets
- Document any constraint violations found
