# UAT: Feature 28.1 - Configurable Approval Workflows

## Test Environment Setup

**Prerequisites:**
- Admin user with workflow configuration permissions
- Multiple manager users at different levels
- Employee users for testing requests
- Existing leave types and shift swap functionality
- Email notifications configured

**Test URL:** `/settings/approval-workflows`

---

## Test Cases

### TC-28.1.1: Access Workflow Configuration

**Steps:**
1. Log in as admin
2. Navigate to Settings
3. Click on "Approval Workflows"

**Expected Results:**
- [ ] Workflow configuration page loads
- [ ] List of existing workflows (if any) displayed
- [ ] "Create New Workflow" button visible
- [ ] Can see workflow types (leave, swaps, overtime, etc.)

---

### TC-28.1.2: Create Simple Approval Workflow

**Steps:**
1. Click "Create New Workflow"
2. Enter workflow name: "Standard Leave Approval"
3. Select type: "Leave Request"
4. Add single approver step: "Direct Manager"
5. Save workflow

**Expected Results:**
- [ ] Workflow form opens
- [ ] Can enter name and select type
- [ ] Can add approval steps
- [ ] Workflow saves successfully
- [ ] Workflow appears in list

---

### TC-28.1.3: Create Multi-Step Approval Workflow

**Steps:**
1. Create new workflow: "Extended Leave Approval"
2. Select type: "Leave Request"
3. Add Step 1: "Direct Manager"
4. Add Step 2: "Department Head"
5. Add Step 3: "HR Manager"
6. Save workflow

**Expected Results:**
- [ ] Can add multiple sequential steps
- [ ] Steps are numbered/ordered
- [ ] Each step has approver selection
- [ ] Workflow saves successfully
- [ ] All steps visible in workflow view

---

### TC-28.1.4: Workflow Designer UI

**Steps:**
1. Open workflow designer
2. Drag and drop steps (if supported)
3. Reorder steps
4. Delete a step

**Expected Results:**
- [ ] Visual workflow designer loads
- [ ] Can visualize approval chain
- [ ] Steps can be reordered
- [ ] Steps can be removed
- [ ] Changes reflect immediately

---

### TC-28.1.5: Condition-Based Workflow Matching

**Steps:**
1. Create workflow: "Long Leave Approval"
2. Add condition: "Leave duration > 5 days"
3. Add approval steps
4. Create another workflow for short leave
5. Add condition: "Leave duration <= 5 days"
6. Save both

**Expected Results:**
- [ ] Can add conditions to workflows
- [ ] Multiple conditions can be combined (AND/OR)
- [ ] Condition types: duration, leave type, amount, etc.
- [ ] Workflows with conditions save correctly
- [ ] System matches correct workflow based on conditions

---

### TC-28.1.6: Assign Workflow to Leave Type

**Steps:**
1. Navigate to leave type settings
2. Select a leave type (e.g., "Annual Leave")
3. Assign an approval workflow
4. Save changes

**Expected Results:**
- [ ] Workflow assignment option available
- [ ] Dropdown shows available workflows
- [ ] Assignment saves successfully
- [ ] Leave type shows assigned workflow

---

### TC-28.1.7: Submit Request - Triggers Workflow

**Steps:**
1. Log in as employee
2. Submit a leave request for a type with assigned workflow
3. Submit the request

**Expected Results:**
- [ ] Request is created
- [ ] Workflow is triggered automatically
- [ ] Request status shows "Pending Approval"
- [ ] First approver in chain is notified
- [ ] Employee sees pending status

---

### TC-28.1.8: First Approver Receives Request

**Steps:**
1. Log in as the first approver (Direct Manager)
2. Check notifications/dashboard
3. View pending approvals

**Expected Results:**
- [ ] Notification received about pending approval
- [ ] Request appears in approval queue
- [ ] Can see request details
- [ ] Can see you are Step 1 of N
- [ ] Approve/Reject options available

---

### TC-28.1.9: Approve at Step 1 (Multi-Step Workflow)

**Steps:**
1. Log in as Step 1 approver
2. Open pending request
3. Click "Approve"
4. Add optional comment
5. Confirm approval

**Expected Results:**
- [ ] Approval is recorded
- [ ] Request moves to Step 2
- [ ] Step 2 approver is notified
- [ ] Request status shows "Pending Step 2"
- [ ] Step 1 approval is logged with timestamp

---

### TC-28.1.10: Approve at Final Step

**Steps:**
1. Complete all previous steps
2. Log in as final approver
3. Approve the request

**Expected Results:**
- [ ] Final approval is recorded
- [ ] Request status changes to "Approved"
- [ ] Original requester is notified
- [ ] Full approval chain is visible in history
- [ ] Leave is confirmed on calendar

---

### TC-28.1.11: Reject at Any Step

**Steps:**
1. Initiate a multi-step approval
2. Log in as any approver in the chain
3. Click "Reject"
4. Enter rejection reason (required)
5. Confirm rejection

**Expected Results:**
- [ ] Rejection reason is required
- [ ] Request status changes to "Rejected"
- [ ] Workflow stops (no further approvers)
- [ ] Original requester is notified
- [ ] Rejection reason visible to requester

---

### TC-28.1.12: Approval Dashboard

**Steps:**
1. Log in as a manager/approver
2. Navigate to Approval Dashboard
3. Review pending items

**Expected Results:**
- [ ] Shows all items awaiting your approval
- [ ] Grouped by type (leave, swaps, etc.)
- [ ] Shows how long each has been pending
- [ ] Shows request priority
- [ ] Quick approve/reject actions available

---

### TC-28.1.13: Escalation on Timeout

**Steps:**
1. Configure workflow with 48-hour timeout
2. Submit a request
3. Do NOT approve for 48 hours (simulate or adjust time)
4. Check escalation behavior

**Expected Results:**
- [ ] Timeout is tracked
- [ ] After timeout, escalation occurs
- [ ] Next level approver is notified
- [ ] Or admin is alerted
- [ ] Timeout warning sent before escalation

---

### TC-28.1.14: View Approval History

**Steps:**
1. Log in as admin
2. Navigate to a completed request
3. View approval history/audit trail

**Expected Results:**
- [ ] Full workflow history visible
- [ ] Each step shows approver name
- [ ] Each step shows action (approve/reject)
- [ ] Each step shows timestamp
- [ ] Comments visible

---

### TC-28.1.15: Edit Existing Workflow

**Steps:**
1. Navigate to workflow list
2. Click edit on existing workflow
3. Add a new step
4. Change an approver
5. Save changes

**Expected Results:**
- [ ] Can edit existing workflows
- [ ] Changes save successfully
- [ ] Existing in-progress requests use old workflow
- [ ] New requests use updated workflow
- [ ] Warning shown about in-progress requests

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test workflows with different request types
- Test with users at various organizational levels
