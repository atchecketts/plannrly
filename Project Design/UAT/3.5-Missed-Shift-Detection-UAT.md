# UAT: Feature 3.5 - Missed Shift Detection

## Test Environment Setup

**Prerequisites:**
- One admin user
- Multiple employee users with assigned shifts
- Published shifts that have passed without clock-in
- Tenant with clock-in enabled
- Grace period configured (e.g., 15 minutes)

**Test URLs:**
- Dashboard: `/dashboard`
- Time Entries: `/time-entries`
- Shifts: `/schedule`

---

## Test Cases

### TC-3.5.1: Detect Missed Shift (No Clock-In)

**Steps:**
1. Log in as admin
2. Create a published shift for Employee A starting 2 hours ago
3. Ensure Employee A did NOT clock in
4. Wait for detection job or trigger manually
5. Check time entries

**Expected Results:**
- [ ] Time entry created with status "missed"
- [ ] Entry shows scheduled shift details
- [ ] No clock-in/out times recorded
- [ ] Entry flagged as no-show

---

### TC-3.5.2: No False Positive for Clocked-In Shift

**Steps:**
1. Log in as admin
2. Ensure Employee B has a shift and DID clock in
3. Run missed shift detection

**Expected Results:**
- [ ] No duplicate missed entry created
- [ ] Existing time entry remains
- [ ] Status is "completed" or "in_progress"
- [ ] No false no-show flag

---

### TC-3.5.3: Grace Period Respected

**Steps:**
1. Log in as admin
2. Create shift starting 10 minutes ago
3. Grace period is 15 minutes
4. Run detection job

**Expected Results:**
- [ ] Shift NOT marked as missed yet
- [ ] Employee still has time to clock in
- [ ] Run again after 15+ min if no clock-in
- [ ] Then marked as missed

---

### TC-3.5.4: Manager Notification on Missed Shift

**Steps:**
1. Create scenario where shift is missed
2. Let detection job run
3. Log in as admin/manager
4. Check notifications

**Expected Results:**
- [ ] Manager receives notification
- [ ] Notification shows employee name
- [ ] Shows shift date and time
- [ ] Link to view details

---

### TC-3.5.5: Missed Shift in Dashboard

**Steps:**
1. Create missed shift scenario
2. Log in as admin
3. View dashboard

**Expected Results:**
- [ ] Missed shift indicator visible
- [ ] Shows count of missed shifts
- [ ] Click navigates to details
- [ ] Urgency indicated

---

### TC-3.5.6: Employee Sees Own Missed Shift

**Steps:**
1. Log in as the employee who missed a shift
2. View dashboard or time entries

**Expected Results:**
- [ ] Employee sees missed shift
- [ ] Status clearly shown as "Missed"
- [ ] May prompt for explanation
- [ ] Cannot edit/change status

---

### TC-3.5.7: Missed Shift Report

**Steps:**
1. Log in as admin
2. Navigate to attendance reports
3. Find missed shift section

**Expected Results:**
- [ ] Shows all missed shifts
- [ ] Filter by date range
- [ ] Filter by employee
- [ ] Shows pattern analysis

---

### TC-3.5.8: Late Clock-In After Missed Detection

**Steps:**
1. Have shift marked as missed
2. Employee tries to clock in late (shift already started)

**Expected Results:**
- [ ] Clock-in may still be allowed
- [ ] Missed status may update to "Late"
- [ ] Or separate late entry created
- [ ] Variance recorded appropriately

---

### TC-3.5.9: Detection Does Not Run for Future Shifts

**Steps:**
1. Log in as admin
2. Ensure no future shifts are marked as missed

**Expected Results:**
- [ ] Only past shifts are checked
- [ ] Current day shifts within grace ignored
- [ ] Future shifts untouched
- [ ] Logic checks shift start time correctly

---

### TC-3.5.10: Detection Runs Periodically

**Steps:**
1. Log in as admin
2. Check scheduler configuration
3. Verify detection command is scheduled

**Expected Results:**
- [ ] Command runs every 15 minutes (or configured)
- [ ] Catches missed shifts promptly
- [ ] No long delays in detection
- [ ] Does not run excessively

---

### TC-3.5.11: Missed Shift for Multiple Employees

**Steps:**
1. Log in as admin
2. Create shifts for 3 employees same time
3. Only 1 clocks in
4. Run detection

**Expected Results:**
- [ ] 2 missed entries created
- [ ] 1 existing entry unchanged
- [ ] Each missed entry has correct employee
- [ ] Notifications sent for each

---

### TC-3.5.12: Tenant Isolation for Missed Detection

**Steps:**
1. Create missed shift in Tenant A
2. Log in as admin of Tenant B
3. View missed shifts

**Expected Results:**
- [ ] Tenant B cannot see Tenant A's missed shifts
- [ ] Detection runs per tenant
- [ ] No cross-tenant data leakage

---

### TC-3.5.13: Missed Shift Count on Manager Dashboard

**Steps:**
1. Create multiple missed shifts today
2. Log in as admin
3. View dashboard summary

**Expected Results:**
- [ ] Shows "X missed shifts today"
- [ ] Count is accurate
- [ ] Updates when new misses detected
- [ ] Clickable to view list

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test timezone edge cases
