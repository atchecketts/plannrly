# UAT: Feature 7.2 - AI Scheduling API and UI

## Test Environment Setup

**Prerequisites:**
- Admin user with AI Scheduling feature enabled (Premium/Enterprise plan or add-on)
- Admin user without AI Scheduling feature (for upgrade prompt testing)
- Multiple employees with roles, availability, and target hours configured
- Unassigned shifts on the schedule
- Some already assigned shifts for replacement testing

**Test URL:** `/schedule` (with AI controls), `/schedule/ai/*`

---

## Test Cases

### TC-7.2.1: AI Feature Visibility (Feature Enabled)

**Steps:**
1. Log in as admin with AI Scheduling feature enabled
2. Navigate to Schedule view

**Expected Results:**
- [ ] "Auto-Fill" or "AI Schedule" button is visible in toolbar
- [ ] "Generate Schedule" option is available
- [ ] AI-related controls are displayed
- [ ] Feature works without errors

---

### TC-7.2.2: AI Feature Hidden (Feature Disabled)

**Steps:**
1. Log in as admin WITHOUT AI Scheduling feature
2. Navigate to Schedule view

**Expected Results:**
- [ ] AI scheduling buttons are NOT visible
- [ ] Or shows "Upgrade" prompt instead of button
- [ ] API endpoints return feature-disabled error
- [ ] User sees upgrade call-to-action

---

### TC-7.2.3: Upgrade Prompt Display

**Steps:**
1. Log in as admin without AI feature
2. Navigate to Schedule
3. Look for AI feature or upgrade prompt

**Expected Results:**
- [ ] Clear indication that AI scheduling is premium
- [ ] Link to upgrade subscription
- [ ] Information about what AI scheduling offers
- [ ] No errors or broken UI

---

### TC-7.2.4: Open Generate Schedule Modal

**Steps:**
1. Log in as admin with AI feature
2. Navigate to Schedule
3. Click "Generate Schedule" or "AI Auto-Fill"

**Expected Results:**
- [ ] Modal dialog opens
- [ ] Shows options for generation
- [ ] Date range selector is visible
- [ ] Generate button is available

---

### TC-7.2.5: Generate Full Schedule

**Steps:**
1. Log in as admin with AI feature
2. Open AI scheduling modal
3. Select date range for schedule generation
4. Select "Generate Full Schedule" option
5. Click "Generate"

**Expected Results:**
- [ ] Loading indicator shows during processing
- [ ] Suggestions are generated
- [ ] Preview of proposed assignments is shown
- [ ] Can review before applying

---

### TC-7.2.6: Fill Only Unassigned Shifts

**Steps:**
1. Log in as admin with AI feature
2. Have some shifts assigned, some unassigned
3. Open AI scheduling modal
4. Select "Fill Unassigned Shifts Only"
5. Click "Generate"

**Expected Results:**
- [ ] Only unassigned shifts get suggestions
- [ ] Existing assignments are preserved
- [ ] Preview shows which shifts will be filled
- [ ] Already-assigned shifts are unchanged

---

### TC-7.2.7: Preview Suggested Assignments

**Steps:**
1. Generate AI schedule suggestions
2. View the preview interface

**Expected Results:**
- [ ] Each suggestion shows shift details
- [ ] Shows proposed employee name
- [ ] Shows match score or quality indicator
- [ ] Any warnings are highlighted
- [ ] Can see reasoning for assignment

---

### TC-7.2.8: View Scoring Breakdown

**Steps:**
1. Generate AI schedule suggestions
2. Click on a suggestion to see details
3. View the scoring breakdown

**Expected Results:**
- [ ] Shows individual constraint scores
- [ ] Target hours impact is shown
- [ ] Preference level is displayed
- [ ] Fair distribution score visible
- [ ] Overall score is calculated

---

### TC-7.2.9: Apply All Suggestions

**Steps:**
1. Generate AI schedule with multiple suggestions
2. Review the preview
3. Click "Apply All"

**Expected Results:**
- [ ] All suggestions are applied
- [ ] Schedule updates with new assignments
- [ ] Success message is shown
- [ ] Modal closes after applying
- [ ] Can see assignments on schedule

---

### TC-7.2.10: Apply Individual Suggestion

**Steps:**
1. Generate AI schedule with multiple suggestions
2. Review the preview
3. Click "Apply" on a single suggestion
4. Leave others unapplied

**Expected Results:**
- [ ] Only selected suggestion is applied
- [ ] Other suggestions remain in preview
- [ ] Can apply remaining one by one
- [ ] Schedule updates for applied assignment

---

### TC-7.2.11: Reject/Skip Suggestion

**Steps:**
1. Generate AI schedule with multiple suggestions
2. Click "Skip" or "Reject" on a suggestion

**Expected Results:**
- [ ] Suggestion is removed from preview
- [ ] Can request alternative for that shift
- [ ] Other suggestions remain
- [ ] Skipped shift stays unassigned

---

### TC-7.2.12: Find Replacement for Shift

**Steps:**
1. Log in as admin with AI feature
2. Navigate to an assigned shift
3. Click "Find Replacement" option

**Expected Results:**
- [ ] AI searches for replacement employees
- [ ] Shows ranked list of candidates
- [ ] Scoring shows why each candidate fits
- [ ] Can select and apply replacement

---

### TC-7.2.13: Display Warnings for Conflicts

**Steps:**
1. Generate AI schedule
2. View any shifts with warnings

**Expected Results:**
- [ ] Warnings are highlighted (yellow/orange)
- [ ] Shows what the conflict is (near max hours, etc.)
- [ ] Can still apply with acknowledgment
- [ ] Helps admin make informed decision

---

### TC-7.2.14: Display Unfillable Shifts

**Steps:**
1. Create shift with role no one has
2. Run AI scheduling

**Expected Results:**
- [ ] Unfillable shifts are clearly identified
- [ ] Shows reason (no qualified employees)
- [ ] Suggests manual assignment
- [ ] Does not prevent other assignments

---

### TC-7.2.15: Undo Capability

**Steps:**
1. Apply AI scheduling suggestions
2. Look for undo option
3. Click undo within time window

**Expected Results:**
- [ ] Undo option is available after applying
- [ ] Can revert recent AI assignments
- [ ] Schedule returns to previous state
- [ ] Confirmation before undo

---

### TC-7.2.16: API Rate Limiting

**Steps:**
1. Rapidly click Generate multiple times
2. Check for rate limiting behavior

**Expected Results:**
- [ ] System prevents rapid repeated requests
- [ ] Appropriate message about rate limiting
- [ ] Single request completes successfully
- [ ] No performance degradation

---

### TC-7.2.17: Cancel Generation In Progress

**Steps:**
1. Start AI schedule generation
2. Click "Cancel" during processing

**Expected Results:**
- [ ] Generation stops
- [ ] Modal returns to initial state
- [ ] No partial changes applied
- [ ] Can start fresh generation

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test with slow network to verify loading states
- Verify feature gating works correctly
- Document performance with large schedules
