# UAT: Feature 17.1 - EU Working Time Directive Monitoring

## Test Environment Setup

**Prerequisites:**
- Admin accounts
- Multiple employees with shift history
- Published schedules with various shift patterns
- Compliance rules configured

**Test URLs:**
- Compliance Dashboard: `/admin/compliance`
- Compliance Report: `/admin/compliance/report`
- Compliance Settings: `/admin/compliance/settings`
- Schedule View: `/schedule`

---

## Test Cases

### TC-17.1.1: Compliance Dashboard Loads

**Steps:**
1. Log in as admin
2. Navigate to Compliance dashboard

**Expected Results:**
- [ ] Dashboard loads without errors
- [ ] Overview statistics displayed
- [ ] Recent violations listed
- [ ] Navigation to detailed views available

---

### TC-17.1.2: Rest Period Violation Detection

**Steps:**
1. Create shift ending at 10 PM for Employee A
2. Create shift starting at 6 AM next day for same employee (8 hours rest)
3. Observe compliance check

**Expected Results:**
- [ ] Warning displayed for insufficient rest
- [ ] Message indicates 11 hours required, 8 provided
- [ ] Violation severity indicated
- [ ] Option to override with acknowledgment

---

### TC-17.1.3: Rest Period Compliant

**Steps:**
1. Create shift ending at 6 PM for Employee B
2. Create shift starting at 6 AM next day (12 hours rest)

**Expected Results:**
- [ ] No warning displayed
- [ ] Shift created normally
- [ ] Compliance check passes

---

### TC-17.1.4: Weekly Hours Violation Detection

**Steps:**
1. Schedule Employee C for 50 hours in one week
2. Check compliance warnings

**Expected Results:**
- [ ] Warning for exceeding 48-hour weekly limit
- [ ] Shows current hours vs maximum
- [ ] Violation logged
- [ ] Option to override

---

### TC-17.1.5: Weekly Rest Period Violation

**Steps:**
1. Schedule employee for 7 consecutive days without 24-hour rest
2. Check compliance

**Expected Results:**
- [ ] Warning for missing weekly rest period
- [ ] Explains 24-hour rest required per week
- [ ] Suggests adjustments
- [ ] Can be overridden with reason

---

### TC-17.1.6: Break Requirement Check

**Steps:**
1. Create shift longer than 6 hours
2. Check for break requirement warning

**Expected Results:**
- [ ] Warning if 20-minute break not scheduled
- [ ] Or information that break is required
- [ ] Helps ensure compliance

---

### TC-17.1.7: Warning Display in Schedule View

**Steps:**
1. Navigate to schedule view
2. Create a violating shift
3. Observe warning display

**Expected Results:**
- [ ] Warning appears before saving
- [ ] Clear indication of violation
- [ ] Employee name and violation shown
- [ ] Save requires acknowledgment

---

### TC-17.1.8: Acknowledge Violation Override

**Steps:**
1. Trigger a compliance violation
2. Click to override/acknowledge
3. Enter reason: "Employee agreed to extra hours"
4. Submit

**Expected Results:**
- [ ] Override form/modal appears
- [ ] Reason field is required
- [ ] Override saved successfully
- [ ] Violation logged with override status
- [ ] Override reason recorded
- [ ] Admin who overrode recorded

---

### TC-17.1.9: Violation Override Without Reason

**Steps:**
1. Trigger a compliance violation
2. Try to override without entering reason

**Expected Results:**
- [ ] Validation error
- [ ] Reason is mandatory
- [ ] Cannot proceed without reason

---

### TC-17.1.10: Compliance Report Generation

**Steps:**
1. Navigate to Compliance Report
2. Select date range
3. Generate report

**Expected Results:**
- [ ] Report generates successfully
- [ ] Lists all violations in period
- [ ] Shows violation types
- [ ] Shows affected employees
- [ ] Shows override status
- [ ] Can export/download

---

### TC-17.1.11: Compliance Settings - Configure Rules

**Steps:**
1. Navigate to Compliance Settings
2. Modify minimum rest hours to 10
3. Save settings

**Expected Results:**
- [ ] Settings page loads
- [ ] Can modify rest period threshold
- [ ] Changes saved
- [ ] New threshold applied to checks

---

### TC-17.1.12: Disable Specific Rule

**Steps:**
1. Navigate to Compliance Settings
2. Disable "Weekly Hours" rule
3. Save
4. Schedule over 48 hours

**Expected Results:**
- [ ] Rule can be toggled off
- [ ] No warning when rule disabled
- [ ] Other rules still active
- [ ] Can re-enable

---

### TC-17.1.13: Violation Logged in Database

**Steps:**
1. Trigger a compliance violation
2. Override with reason
3. Check compliance_violations table

**Expected Results:**
- [ ] Record created in database
- [ ] Tenant ID recorded
- [ ] Employee ID recorded
- [ ] Rule type recorded
- [ ] Override status recorded
- [ ] Reason stored
- [ ] Overriding admin recorded

---

### TC-17.1.14: Multiple Violations for Same Shift

**Steps:**
1. Create shift that violates both rest period and weekly hours

**Expected Results:**
- [ ] Both violations detected
- [ ] Both warnings displayed
- [ ] Each requires acknowledgment
- [ ] Both logged separately

---

### TC-17.1.15: Employee Compliance Summary

**Steps:**
1. View compliance dashboard
2. Click on specific employee
3. View their compliance history

**Expected Results:**
- [ ] Shows employee's violation history
- [ ] Count of violations by type
- [ ] Recent violations listed
- [ ] Helps identify patterns

---

### TC-17.1.16: Compliance Dashboard Statistics

**Steps:**
1. View compliance dashboard overview

**Expected Results:**
- [ ] Total violations this period
- [ ] Violations by type breakdown
- [ ] Overridden vs not overridden
- [ ] Trend over time (if historical data)

---

## Notes

- Test with various shift patterns (night shifts, split shifts)
- Verify calculations handle timezone correctly
- Test edge cases (exactly 11 hours, exactly 48 hours)
- Ensure historical data doesn't trigger new violations
- Check that published vs draft schedules are handled appropriately
- Verify compliance rules match current EU Working Time Directive
