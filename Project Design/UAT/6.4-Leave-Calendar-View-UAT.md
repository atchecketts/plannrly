# UAT: Feature 6.4 - Leave Calendar View (Schedule Integration)

## Test Environment Setup

**Prerequisites:**
- One admin user with full access
- Multiple employees in different departments
- Various leave requests with different leave types (Annual, Sick, etc.)
- Approved leave requests spanning multiple days
- Half-day leave requests (start_half_day and end_half_day)
- Leave types with different colors configured

**Test URLs:**
- Week View: `/schedule`
- Day View: `/schedule/day`

---

## Test Cases

### TC-6.4.1: View Leave in Week Schedule (Admin)

**Steps:**
1. Log in as an admin
2. Navigate to Schedule (week view) at `/schedule`
3. Navigate to a week containing approved leave requests

**Expected Results:**
- [ ] Leave requests are displayed in the day cells
- [ ] Leave blocks show the leave type name (for full-day leave)
- [ ] Leave blocks use the leave type's configured color
- [ ] Leave is shown on all days it covers

---

### TC-6.4.2: View Leave in Day Schedule (Admin)

**Steps:**
1. Log in as an admin
2. Navigate to Schedule day view at `/schedule/day`
3. Select a date with approved leave requests

**Expected Results:**
- [ ] Leave requests are displayed as colored bars on the timeline
- [ ] Leave bars span the full width for full-day leave
- [ ] Leave type name is displayed in the bar
- [ ] Leave uses the leave type's configured color

---

### TC-6.4.3: Color Coding by Leave Type - Week View

**Steps:**
1. Create approved leave requests with different leave types:
   - Annual Leave (blue - #3B82F6)
   - Sick Leave (red - #EF4444)
2. Navigate to the week schedule
3. View the leave blocks

**Expected Results:**
- [ ] Annual leave appears with blue coloring
- [ ] Sick leave appears with red coloring
- [ ] Colors match the LeaveType.color configuration
- [ ] Background is semi-transparent (20% opacity)
- [ ] Border is slightly more opaque (50% opacity)

---

### TC-6.4.4: Color Coding by Leave Type - Day View

**Steps:**
1. Create approved leave requests with different leave types
2. Navigate to the day schedule
3. View the leave bars

**Expected Results:**
- [ ] Each leave type shows in its configured color
- [ ] Colors are clearly distinguishable
- [ ] Text remains readable against the background

---

### TC-6.4.5: Half-Day Leave Display - Week View (PM Only)

**Steps:**
1. Create an approved leave request with:
   - Start date: January 15
   - End date: January 17
   - start_half_day: true (PM only on first day)
2. Navigate to the week schedule for that period

**Expected Results:**
- [ ] January 15: Only the RIGHT half of the cell is filled (PM)
- [ ] January 16: Full cell is filled (all day)
- [ ] January 17: Full cell is filled (all day)
- [ ] PM text label shown on half-day cell

---

### TC-6.4.6: Half-Day Leave Display - Week View (AM Only)

**Steps:**
1. Create an approved leave request with:
   - Start date: January 15
   - End date: January 17
   - end_half_day: true (AM only on last day)
2. Navigate to the week schedule for that period

**Expected Results:**
- [ ] January 15: Full cell is filled (all day)
- [ ] January 16: Full cell is filled (all day)
- [ ] January 17: Only the LEFT half of the cell is filled (AM)
- [ ] AM text label shown on half-day cell

---

### TC-6.4.7: Half-Day Leave Display - Day View (PM Only)

**Steps:**
1. Create an approved single-day leave request with start_half_day: true
2. Navigate to the day schedule for that date

**Expected Results:**
- [ ] Leave bar starts at noon (12:00)
- [ ] Leave bar extends to end of displayed day
- [ ] Shows "PM Leave" text
- [ ] Morning hours are clear/available

---

### TC-6.4.8: Half-Day Leave Display - Day View (AM Only)

**Steps:**
1. Create an approved leave request ending on this day with end_half_day: true
2. Navigate to the day schedule for the end date

**Expected Results:**
- [ ] Leave bar starts at beginning of displayed day
- [ ] Leave bar ends at noon (12:00)
- [ ] Shows "AM Leave" text
- [ ] Afternoon hours are clear/available

---

### TC-6.4.9: Multi-Day Leave Spanning Week

**Steps:**
1. Create a 5-day approved leave request
2. Navigate to the week schedule covering those days

**Expected Results:**
- [ ] Leave appears on all 5 days
- [ ] Each day shows the leave with consistent coloring
- [ ] Leave type name shown on full-day cells

---

### TC-6.4.10: Only Approved Leave Is Shown

**Steps:**
1. Create leave requests with different statuses:
   - One draft leave request
   - One pending (requested) leave request
   - One approved leave request
2. Navigate to the schedule views

**Expected Results:**
- [ ] Only the approved leave request is displayed
- [ ] Draft leave is NOT shown
- [ ] Pending leave is NOT shown

---

### TC-6.4.11: Leave Display Alongside Shifts - Week View

**Steps:**
1. Create a shift for an employee on a specific date
2. Create approved leave for the same employee on a DIFFERENT date
3. Navigate to the week schedule

**Expected Results:**
- [ ] Shift appears on its scheduled date
- [ ] Leave appears on its date
- [ ] Employee row shows both correctly

---

### TC-6.4.12: Leave Takes Precedence Over Shifts

**Steps:**
1. Note: If an employee has approved leave, they should not work
2. Navigate to schedule with employee who has leave

**Expected Results:**
- [ ] Leave block is displayed
- [ ] Any conflicting shifts for that day would be hidden by leave
- [ ] Visual indicates employee is unavailable

---

### TC-6.4.13: Employee View of Own Leave

**Steps:**
1. Log in as an employee with approved leave
2. Navigate to the schedule view
3. Find your row in the schedule

**Expected Results:**
- [ ] Employee can see their own leave on the schedule
- [ ] Leave color and type are visible
- [ ] Half-day leave displays correctly for own leave

---

### TC-6.4.14: Navigate Between Weeks/Days with Leave

**Steps:**
1. Log in as an admin
2. Navigate to schedule with leave in current week
3. Navigate to next week
4. Navigate to previous week
5. Return to current week

**Expected Results:**
- [ ] Leave loads correctly for each week
- [ ] Navigation doesn't break leave display
- [ ] Correct leave shows for each date range

---

### TC-6.4.15: Schedule Day View Hours Configuration

**Steps:**
1. Verify tenant settings for day start/end hours (e.g., 6:00 AM - 10:00 PM)
2. Create half-day leave
3. Navigate to day schedule

**Expected Results:**
- [ ] AM leave covers from day start to noon
- [ ] PM leave covers from noon to day end
- [ ] Leave positioning respects tenant hour configuration

---

### TC-6.4.16: Leave with Custom Color

**Steps:**
1. Create a leave type with a custom color (e.g., #8B5CF6 purple)
2. Create approved leave using that type
3. Navigate to schedule views

**Expected Results:**
- [ ] Leave displays in the custom purple color
- [ ] Color is consistent in both week and day views
- [ ] Color is readable and distinguishable

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test with multiple employees having leave on the same day
- Verify colors are accessible (sufficient contrast)
- Check that leave type names truncate gracefully if too long
