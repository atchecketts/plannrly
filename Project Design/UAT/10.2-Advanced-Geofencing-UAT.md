# UAT: Feature 10.2 - Advanced Geofencing (Premium)

## Test Environment Setup

**Prerequisites:**
- Admin user with premium subscription
- Location with address configured
- Mobile device with GPS capability
- Employee accounts for testing
- Browser with location permission

**Test URL:** `/locations/{id}/geofence`, `/geofence-events`

---

## Test Cases

### TC-10.2.1: Feature Gate - Premium Required

**Steps:**
1. Log in as admin without premium subscription
2. Try to access geofence configuration

**Expected Results:**
- [ ] Access denied or upgrade prompt shown
- [ ] Feature marked as premium
- [ ] Basic location management still works

---

### TC-10.2.2: Configure Geofence for Location

**Steps:**
1. Log in as admin with premium
2. Navigate to a location's settings
3. Open Geofence configuration
4. Set center point (lat/long)
5. Set radius (e.g., 100 meters)
6. Save

**Expected Results:**
- [ ] Geofence config page loads
- [ ] Map displays location
- [ ] Can set center point by clicking map
- [ ] Radius slider/input works
- [ ] Visual circle shows geofence boundary
- [ ] Configuration saves successfully

---

### TC-10.2.3: Map Interface Usability

**Steps:**
1. Open geofence configuration
2. Pan and zoom the map
3. Click to set center point
4. Adjust radius

**Expected Results:**
- [ ] Map is interactive
- [ ] Can search for address
- [ ] Click accurately places marker
- [ ] Radius circle updates in real-time

---

### TC-10.2.4: Enforce Clock-In Within Geofence

**Steps:**
1. Configure geofence for a location
2. Enable "Require clock-in within geofence"
3. As employee, try to clock in from OUTSIDE geofence
4. Try to clock in from INSIDE geofence

**Expected Results:**
- [ ] Clock-in blocked when outside geofence
- [ ] Clear error message shown
- [ ] Clock-in succeeds when inside geofence
- [ ] Geofence check logged

---

### TC-10.2.5: Geofence Violation Alert

**Steps:**
1. Configure geofence with enforcement
2. As employee, attempt clock-in outside geofence
3. Observe manager notifications

**Expected Results:**
- [ ] Violation event is recorded
- [ ] Manager receives violation alert
- [ ] Alert includes employee, time, location
- [ ] Can view violation in geofence events

---

### TC-10.2.6: Auto Clock-In on Geofence Entry

**Steps:**
1. Enable "Auto clock-in on entry" for location
2. As employee with app, enter geofence area
3. Observe clock status

**Expected Results:**
- [ ] Clock-in triggered automatically
- [ ] Notification shown to employee
- [ ] Clock event recorded with geofence entry note
- [ ] Only triggers during scheduled shift time

---

### TC-10.2.7: Auto Clock-Out on Geofence Exit

**Steps:**
1. Enable "Auto clock-out on exit" for location
2. While clocked in, leave geofence area
3. Observe clock status

**Expected Results:**
- [ ] Clock-out triggered automatically
- [ ] Notification shown to employee
- [ ] Clock event recorded with geofence exit note
- [ ] Grace period before auto clock-out (configurable)

---

### TC-10.2.8: GPS Trail for Mobile Workers

**Steps:**
1. Enable GPS tracking for mobile worker role
2. As mobile worker, clock in and move locations
3. As manager, view GPS trail

**Expected Results:**
- [ ] GPS points recorded periodically
- [ ] Trail viewable on map
- [ ] Timestamps for each point
- [ ] Privacy controls respected

---

### TC-10.2.9: View Geofence Events

**Steps:**
1. Log in as manager
2. Navigate to Geofence Events
3. View event history

**Expected Results:**
- [ ] List of geofence events displayed
- [ ] Shows entries, exits, violations
- [ ] Filterable by date, employee, location
- [ ] Event details accessible

---

### TC-10.2.10: Geofence Event Details

**Steps:**
1. Click on a geofence event
2. View full details

**Expected Results:**
- [ ] Shows event type (entry/exit/violation)
- [ ] Shows employee name
- [ ] Shows timestamp
- [ ] Shows location coordinates
- [ ] Shows distance from geofence center

---

### TC-10.2.11: Multiple Location Geofences

**Steps:**
1. Configure geofences for multiple locations
2. As employee, visit different locations
3. Test clock-in at each

**Expected Results:**
- [ ] Each location has independent geofence
- [ ] Correct geofence checked based on shift location
- [ ] No cross-location interference

---

### TC-10.2.12: Location Permission Handling

**Steps:**
1. Attempt geofence action without location permission
2. Deny location permission when prompted
3. Attempt with location permission

**Expected Results:**
- [ ] Clear prompt for location permission
- [ ] Graceful handling when denied
- [ ] Alternative available (manual entry with note)
- [ ] Works correctly when permission granted

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test in areas with poor GPS signal
- Verify battery usage is reasonable
