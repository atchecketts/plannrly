# UAT: Feature 23.1 - Enhanced Offline Support

## Test Environment Setup

**Prerequisites:**
- Mobile device or browser with offline simulation
- Employee account with scheduled shifts
- Network toggle capability (airplane mode)
- PWA installed (if applicable)

**Test URL:** `/dashboard`, `/schedule`, `/time-clock`

---

## Test Cases

### TC-23.1.1: Service Worker Installation

**Steps:**
1. Open the application in a browser
2. Check browser DevTools > Application > Service Workers

**Expected Results:**
- [ ] Service worker is installed
- [ ] Status shows "activated"
- [ ] No errors in console
- [ ] Caching strategy active

---

### TC-23.1.2: Offline Page Display

**Steps:**
1. Load the application while online
2. Turn off network (airplane mode)
3. Navigate to a new page

**Expected Results:**
- [ ] Offline fallback page shown (or cached page)
- [ ] No browser error page
- [ ] Clear indication of offline status
- [ ] Option to retry when back online

---

### TC-23.1.3: View Schedule Offline

**Steps:**
1. Navigate to Schedule while online
2. View your upcoming shifts
3. Go offline
4. Refresh or navigate to Schedule

**Expected Results:**
- [ ] Cached schedule data displayed
- [ ] Shows shifts from last sync
- [ ] Offline indicator visible
- [ ] Read-only mode clear

---

### TC-23.1.4: Offline Indicator in UI

**Steps:**
1. Go offline while using the app
2. Observe the UI

**Expected Results:**
- [ ] Offline indicator/banner appears
- [ ] Clear visual distinction
- [ ] Indicates limited functionality
- [ ] Updates when back online

---

### TC-23.1.5: Clock In While Offline

**Steps:**
1. Log in and be online initially
2. Go offline
3. Navigate to Time Clock
4. Clock in

**Expected Results:**
- [ ] Clock in action is accepted
- [ ] Timestamp preserved locally
- [ ] Shows "pending sync" status
- [ ] Action queued for sync

---

### TC-23.1.6: Clock Out While Offline

**Steps:**
1. Already clocked in (online or offline)
2. Go offline
3. Clock out

**Expected Results:**
- [ ] Clock out action accepted
- [ ] Timestamp preserved
- [ ] Shows pending sync status
- [ ] Duration calculated locally

---

### TC-23.1.7: Sync Queue After Reconnection

**Steps:**
1. Perform actions while offline (clock in, clock out)
2. Return online
3. Wait for sync or manually trigger

**Expected Results:**
- [ ] Queued actions sync automatically
- [ ] Original timestamps preserved
- [ ] Success confirmation shown
- [ ] Local queue cleared

---

### TC-23.1.8: Timestamp Preservation

**Steps:**
1. Clock in offline at 9:00 AM
2. Remain offline until 9:30 AM
3. Go online and sync

**Expected Results:**
- [ ] Clock in recorded as 9:00 AM
- [ ] NOT 9:30 AM when synced
- [ ] Server respects client timestamp
- [ ] Audit trail shows offline origin

---

### TC-23.1.9: Sync Conflict Resolution

**Steps:**
1. Go offline on Device A
2. On Device B (online), modify your shift
3. On Device A (still offline), clock in
4. Bring Device A online

**Expected Results:**
- [ ] Conflict detected
- [ ] Resolution strategy applied (or user prompted)
- [ ] No data loss
- [ ] Both actions recorded appropriately

---

### TC-23.1.10: IndexedDB Storage

**Steps:**
1. Open DevTools > Application > IndexedDB
2. Navigate through the app online
3. Check stored data

**Expected Results:**
- [ ] IndexedDB databases created
- [ ] Schedule data stored locally
- [ ] Sync queue visible
- [ ] Data structured correctly

---

### TC-23.1.11: PWA Installation

**Steps:**
1. Visit the app on mobile browser
2. Accept "Add to Home Screen" prompt
3. Open app from home screen

**Expected Results:**
- [ ] App installs as PWA
- [ ] Opens in standalone mode
- [ ] No browser chrome
- [ ] Offline functionality works

---

### TC-23.1.12: Background Sync (If Supported)

**Steps:**
1. Perform actions while offline
2. Close the app/browser
3. Return online (without opening app)
4. Open app later

**Expected Results:**
- [ ] Background sync attempted
- [ ] Actions synced when connectivity restored
- [ ] User informed of sync results
- [ ] (Browser support may vary)

---

### TC-23.1.13: Cache Updates on Reconnection

**Steps:**
1. View schedule while online
2. Go offline
3. Manager updates your schedule (from their device)
4. Return online on your device

**Expected Results:**
- [ ] New data fetched on reconnection
- [ ] Cache updated with fresh data
- [ ] UI reflects latest changes
- [ ] Notification of updates (if significant)

---

### TC-23.1.14: Offline Data Limits

**Steps:**
1. Observe storage usage
2. Navigate extensively while online
3. Check storage limits

**Expected Results:**
- [ ] Reasonable storage usage
- [ ] Old cached data purged
- [ ] Priority data (upcoming shifts) preserved
- [ ] No storage quota errors

---

### TC-23.1.15: Graceful Degradation

**Steps:**
1. Go offline
2. Try to access features requiring server data
3. Observe behavior

**Expected Results:**
- [ ] Clear messaging for unavailable features
- [ ] Available features work offline
- [ ] No crashes or errors
- [ ] User guided on what they can do

---

## Notes

- Record any bugs or issues found during testing
- Test on multiple devices (iOS, Android, desktop)
- Note any browser-specific behaviors
- Document sync timing and reliability
