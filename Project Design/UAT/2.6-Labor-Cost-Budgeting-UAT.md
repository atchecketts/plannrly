# UAT: Feature 2.6 - Labor Cost Budgeting

## Test Environment Setup

**Prerequisites:**
- One admin user
- Multiple employees with hourly rates configured
- Published shifts with various durations
- At least two locations
- Time entries for actual cost tracking

**Test URLs:**
- Labor Budgets: `/budgets`
- Schedule: `/schedule`

---

## Test Cases

### TC-2.6.1: View Labor Budgets Index

**Steps:**
1. Log in as an admin
2. Navigate to Settings or Finance section
3. Click "Labor Budgets"

**Expected Results:**
- [ ] Page loads successfully
- [ ] Shows list of existing budgets (or empty state)
- [ ] "Add Budget" button is visible
- [ ] Each budget shows location, period, amount

---

### TC-2.6.2: Create Weekly Labor Budget

**Steps:**
1. Log in as an admin
2. Navigate to Labor Budgets
3. Click "Add Budget"
4. Fill in the form:
   - Select location
   - Period type: Weekly
   - Budget amount: $5,000
   - Warning threshold: 80%
   - Critical threshold: 95%
5. Save

**Expected Results:**
- [ ] Form submits successfully
- [ ] Budget appears in list
- [ ] Shows period and amount
- [ ] Success message displayed

---

### TC-2.6.3: Create Monthly Labor Budget

**Steps:**
1. Log in as an admin
2. Create labor budget
3. Select "Monthly" period type
4. Set budget amount
5. Save

**Expected Results:**
- [ ] Monthly option available
- [ ] Budget tracks monthly period
- [ ] Start/end dates calculated correctly
- [ ] Budget saved successfully

---

### TC-2.6.4: Create Department-Specific Budget

**Steps:**
1. Log in as an admin
2. Create labor budget
3. Select location
4. Select specific department
5. Set budget amount
6. Save

**Expected Results:**
- [ ] Department dropdown available after location selected
- [ ] Budget scoped to department
- [ ] Only tracks that department's labor
- [ ] List shows department scope

---

### TC-2.6.5: Edit Labor Budget

**Steps:**
1. Log in as an admin
2. Navigate to Labor Budgets
3. Click "Edit" on an existing budget
4. Change amount and thresholds
5. Save

**Expected Results:**
- [ ] Edit form shows current values
- [ ] Changes are saved
- [ ] Budget indicators update
- [ ] Success message shown

---

### TC-2.6.6: Budget Indicator on Schedule - Under Budget

**Steps:**
1. Log in as an admin
2. Create budget: $5,000 weekly
3. Schedule shifts totaling $2,000
4. View schedule week view

**Expected Results:**
- [ ] Budget indicator shows GREEN
- [ ] Shows "40% of budget used"
- [ ] Remaining budget displayed
- [ ] No warnings shown

---

### TC-2.6.7: Budget Indicator - Warning Threshold

**Steps:**
1. Log in as an admin
2. Create budget: $5,000 weekly, warning at 80%
3. Schedule shifts totaling $4,200 (84%)
4. View schedule

**Expected Results:**
- [ ] Budget indicator shows YELLOW/ORANGE
- [ ] Warning message displayed
- [ ] Shows approaching limit
- [ ] Percentage clearly visible

---

### TC-2.6.8: Budget Indicator - Critical Threshold

**Steps:**
1. Log in as an admin
2. Create budget: $5,000, critical at 95%
3. Schedule shifts totaling $4,900 (98%)
4. View schedule

**Expected Results:**
- [ ] Budget indicator shows RED
- [ ] Critical warning message
- [ ] "Over budget" or "Near limit" shown
- [ ] Alert is prominent

---

### TC-2.6.9: Budget Exceeded Warning

**Steps:**
1. Log in as an admin
2. Create budget: $5,000 weekly
3. Schedule shifts totaling $5,500
4. View schedule

**Expected Results:**
- [ ] Budget shows EXCEEDED status
- [ ] Shows amount over budget
- [ ] Warning may appear when adding shifts
- [ ] Clear visual indication

---

### TC-2.6.10: Cost Calculation from Hourly Rates

**Steps:**
1. Log in as an admin
2. Create employee with hourly rate $20
3. Schedule 8-hour shift for this employee
4. View budget calculation

**Expected Results:**
- [ ] Scheduled cost = $160 (8 x $20)
- [ ] Break time deducted if configured
- [ ] Cost attributed to correct budget
- [ ] Calculation is accurate

---

### TC-2.6.11: Budget Tooltip Details

**Steps:**
1. Log in as an admin
2. Hover over budget indicator on schedule

**Expected Results:**
- [ ] Tooltip shows total budget
- [ ] Shows scheduled cost
- [ ] Shows actual cost (from time entries)
- [ ] Shows remaining budget
- [ ] Shows percentage used

---

### TC-2.6.12: Warning When Adding Shift Exceeds Budget

**Steps:**
1. Log in as an admin
2. Create budget near 100% usage
3. Try to create additional shift
4. Observe warning

**Expected Results:**
- [ ] Warning shown before saving shift
- [ ] Shows how much over budget this would be
- [ ] Option to proceed or cancel
- [ ] Not blocked, just warned

---

### TC-2.6.13: Cost Breakdown by Role

**Steps:**
1. Log in as an admin
2. View budget details
3. Find cost breakdown section

**Expected Results:**
- [ ] Breakdown shows cost per role
- [ ] Waiters: $X, Chefs: $Y, etc.
- [ ] Percentages shown
- [ ] Totals add up correctly

---

### TC-2.6.14: Cost Breakdown by Employee

**Steps:**
1. Log in as an admin
2. View budget details
3. Find employee cost breakdown

**Expected Results:**
- [ ] Lists employees with their costs
- [ ] Shows scheduled hours per employee
- [ ] Shows calculated cost per employee
- [ ] Sorted by cost or name

---

### TC-2.6.15: Actual vs Scheduled Cost Comparison

**Steps:**
1. Log in as an admin
2. Complete a week with time tracking
3. View budget for that week

**Expected Results:**
- [ ] Shows "Scheduled Cost" amount
- [ ] Shows "Actual Cost" amount (from time entries)
- [ ] Variance displayed (over/under)
- [ ] Actual may differ due to overtime, etc.

---

### TC-2.6.16: Budget Notification Alert

**Steps:**
1. Log in as an admin
2. Create budget with alert enabled
3. Schedule shifts to exceed warning threshold
4. Wait for scheduled notification job

**Expected Results:**
- [ ] Admin receives notification
- [ ] Email or in-app notification
- [ ] Shows budget status
- [ ] Link to view details

---

### TC-2.6.17: Historical Budget Snapshots

**Steps:**
1. Log in as an admin
2. Complete a budget period (week/month ends)
3. View historical budgets

**Expected Results:**
- [ ] Completed period is snapshotted
- [ ] Shows final budget vs actual
- [ ] Historical data preserved
- [ ] Can view past period performance

---

### TC-2.6.18: Employee Cannot Access Budgets

**Steps:**
1. Log in as an employee
2. Try to navigate to `/budgets`

**Expected Results:**
- [ ] Access denied (403)
- [ ] Menu item not visible
- [ ] Budget indicators may be hidden from employees

---

## Notes

- Record any bugs or issues found during testing
- Note the browser and device used for testing
- Screenshot any unexpected behavior
- Test with different currencies if applicable
