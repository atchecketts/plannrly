# UAT: Feature 3.4 - Timesheet Views

## Test Environment Setup

**Prerequisites:**
- One admin user
- Multiple employee users with time entries
- Clock In/Out feature enabled in tenant settings
- Completed shifts with time tracking
- Manager approval optionally enabled
- Various departments for filter testing

**Test URLs:**
- Admin Timesheets: `/timesheets`
- Employee Timesheet: `/timesheets/my`

---

## Test Cases

### TC-3.4.1: Admin View All Timesheets

**Steps:**
1. Log in as an admin
2. Navigate to Timesheets in sidebar

**Expected Results:**
- [x] Timesheet index loads at `/timesheets`
- [x] Shows all employees' time entries grouped by employee
- [x] Each employee section shows summary totals
- [x] Week navigation controls visible

---

### TC-3.4.2: Employee View Own Timesheet

**Steps:**
1. Log in as an employee
2. Click Timesheets in sidebar (redirects to `/timesheets/my`)

**Expected Results:**
- [x] Shows "My Timesheet" header
- [x] Only own time entries visible
- [x] Summary cards: Scheduled, Worked, Variance, Breaks, Entries
- [x] Week grid view showing daily entries
- [x] Detailed list view below

---

### TC-3.4.3: Weekly Navigation

**Steps:**
1. Log in as admin or employee
2. Note current week range in header
3. Click left arrow (previous week)
4. Click "Today" / "This Week" button
5. Click right arrow (next week)

**Expected Results:**
- [x] Week range displayed (e.g., "Week of Jan 27 - Feb 02, 2026")
- [x] Previous/Next arrows navigate weeks
- [x] "Today" button returns to current week
- [x] URL updates with `week_start` parameter

---

### TC-3.4.4: Side-by-Side Scheduled vs Actual

**Steps:**
1. Log in as admin
2. View timesheets with entries linked to shifts
3. Check table columns

**Expected Results:**
- [x] Scheduled column shows shift start-end times
- [x] Actual column shows clock in/out times
- [x] Hours column shows total worked
- [x] Both times visible for comparison

---

### TC-3.4.5: Variance Highlighting

**Steps:**
1. Log in as admin
2. View timesheet with various clock-in statuses

**Expected Results:**
- [x] Green badge: On Time
- [x] Yellow badge: Late (within 30 min)
- [x] Red badge: Very Late
- [x] Orange badge: Overtime
- [x] Blue badge: Early clock-in

---

### TC-3.4.6: Total Hours Summary

**Steps:**
1. Log in as employee
2. View My Timesheet
3. Check summary cards at top

**Expected Results:**
- [x] Scheduled hours total displayed
- [x] Worked hours total displayed
- [x] Variance with +/- and color coding
- [x] Break hours total
- [x] Entry count with pending badge

---

### TC-3.4.7: Filter by Employee (Admin)

**Steps:**
1. Log in as admin
2. Navigate to timesheets index
3. Select specific employee from dropdown
4. Click Filter

**Expected Results:**
- [x] Employee dropdown visible
- [x] Shows only selected employee's entries
- [x] Filter persists with week navigation
- [x] "Clear" link removes filter

---

### TC-3.4.8: Filter by Department (Admin)

**Steps:**
1. Log in as admin
2. Select department from dropdown
3. Click Filter

**Expected Results:**
- [x] Department dropdown visible
- [x] Shows only entries for shifts in that department
- [x] Can combine with employee filter

---

### TC-3.4.9: Employee Week Grid View

**Steps:**
1. Log in as employee
2. View My Timesheet week grid

**Expected Results:**
- [x] 7-day grid (Mon-Sun)
- [x] Current day highlighted
- [x] Each day shows entry count and total hours
- [x] Clicking entry links to time entry detail

---

### TC-3.4.10: Batch Approval UI (Admin)

**Steps:**
1. Enable manager approval in tenant settings
2. Log in as admin
3. View timesheets with pending entries

**Expected Results:**
- [x] Checkbox column visible
- [x] "Select All" per employee section
- [x] "Approve Selected" button at bottom
- [x] Checkboxes only on pending (unapproved, clocked-out) entries

---

### TC-3.4.11: Batch Approve Timesheet

**Steps:**
1. Log in as admin
2. Select multiple pending entries
3. Click "Approve Selected"

**Expected Results:**
- [x] Selected entries now show "Approved" status
- [x] Success message shows count approved
- [x] Page refreshes to show updated status

---

### TC-3.4.12: Employee Cannot Approve

**Steps:**
1. Log in as employee
2. View My Timesheet

**Expected Results:**
- [x] No checkboxes visible
- [x] No "Approve Selected" button
- [x] Can only view entries

---

### TC-3.4.13: View Time Entry Details from Timesheet

**Steps:**
1. Log in as any user
2. Click "View" link on a timesheet entry

**Expected Results:**
- [x] Navigates to `/time-entries/{id}`
- [x] Shows full entry details
- [x] Can return to timesheet

---

### TC-3.4.14: Timesheet Empty State

**Steps:**
1. Navigate to week with no time entries

**Expected Results:**
- [x] Week grid shows all 7 days
- [x] "No entry" text for past days
- [x] Detailed view shows "No time entries found"
- [x] No errors or broken layout

---

### TC-3.4.15: Tenant Isolation

**Steps:**
1. Create entries in Tenant A
2. Log in as admin in Tenant B
3. View timesheets

**Expected Results:**
- [x] Only Tenant B entries visible (empty if none)
- [x] Cannot see Tenant A data
- [x] Cannot access via URL manipulation

---

### TC-3.4.16: Navigation Link Visibility

**Steps:**
1. Enable Clock In/Out in tenant settings
2. Verify Timesheets link in sidebar
3. Disable Clock In/Out
4. Refresh page

**Expected Results:**
- [x] Link visible when feature enabled
- [x] Link hidden when feature disabled

---

### TC-3.4.17: Pending Approval Count Badge

**Steps:**
1. Enable manager approval
2. Create pending entries
3. View employee timesheet summary

**Expected Results:**
- [x] Entries card shows total count
- [x] "X pending" badge displayed in amber

---

## Notes

- All times displayed in user-friendly format (e.g., "9:00 AM")
- Dates formatted appropriately (e.g., "Mon, Jan 27")
- Week starts on Monday (Carbon default)
- Batch approval only visible when `require_manager_approval` is true
- Navigation link appears under Time Clock link when enabled
